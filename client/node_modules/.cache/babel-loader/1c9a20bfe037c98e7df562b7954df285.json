{"ast":null,"code":"/**\r\n * DevExtreme (ui/html_editor/modules/mentions.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _renderer = require(\"../../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _quill = require(\"quill\");\n\nvar _quill2 = _interopRequireDefault(_quill);\n\nvar _data = require(\"../../../core/utils/data\");\n\nvar _type = require(\"../../../core/utils/type\");\n\nvar _extend = require(\"../../../core/utils/extend\");\n\nvar _dom = require(\"../../../core/utils/dom\");\n\nvar _events_engine = require(\"../../../events/core/events_engine\");\n\nvar _popup = require(\"./popup\");\n\nvar _popup2 = _interopRequireDefault(_popup);\n\nvar _mention = require(\"../formats/mention\");\n\nvar _mention2 = _interopRequireDefault(_mention);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (\"function\" !== typeof superClass && null !== superClass) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (superClass) {\n    _setPrototypeOf(subClass, superClass);\n  }\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function (o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function () {\n    var result,\n        Super = _getPrototypeOf(Derived);\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (\"object\" === _typeof(call) || \"function\" === typeof call)) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (void 0 === self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (\"undefined\" === typeof Reflect || !Reflect.construct) {\n    return false;\n  }\n\n  if (Reflect.construct.sham) {\n    return false;\n  }\n\n  if (\"function\" === typeof Proxy) {\n    return true;\n  }\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _get(target, property, receiver) {\n  if (\"undefined\" !== typeof Reflect && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) {\n        return;\n      }\n\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n\n    if (null === object) {\n      break;\n    }\n  }\n\n  return object;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function (o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar MentionModule = {};\n\nif (_quill2.default) {\n  var USER_ACTION = \"user\";\n  var SILENT_ACTION = \"silent\";\n  var DEFAULT_MARKER = \"@\";\n  var KEY_CODES = {\n    ARROW_UP: 38,\n    ARROW_DOWN: 40,\n    ARROW_LEFT: 37,\n    ARROW_RIGHT: 39,\n    ENTER: 13,\n    ESCAPE: 27,\n    SPACE: 32,\n    PAGE_UP: 33,\n    PAGE_DOWN: 34,\n    END: 35,\n    HOME: 36\n  };\n  var NAVIGATION_KEYS = [KEY_CODES.ARROW_LEFT, KEY_CODES.ARROW_RIGHT, KEY_CODES.PAGE_UP, KEY_CODES.PAGE_DOWN, KEY_CODES.END, KEY_CODES.HOME];\n  var ALLOWED_PREFIX_CHARS = [\" \", \"\\n\"];\n  var DISABLED_STATE_CLASS = \"dx-state-disabled\";\n\n  _quill2.default.register({\n    \"formats/mention\": _mention2.default\n  }, true);\n\n  MentionModule = function (_PopupModule) {\n    _inherits(MentionModule, _PopupModule);\n\n    var _super = _createSuper(MentionModule);\n\n    _createClass(MentionModule, [{\n      key: \"_getDefaultOptions\",\n      value: function value() {\n        var baseConfig = _get(_getPrototypeOf(MentionModule.prototype), \"_getDefaultOptions\", this).call(this);\n\n        return (0, _extend.extend)(baseConfig, {\n          itemTemplate: \"item\",\n          valueExpr: \"this\",\n          displayExpr: \"this\",\n          template: null,\n          searchExpr: null,\n          searchTimeout: 500,\n          minSearchLength: 0\n        });\n      }\n    }]);\n\n    function MentionModule(quill, options) {\n      var _this;\n\n      _classCallCheck(this, MentionModule);\n\n      _this = _super.call(this, quill, options);\n      _this._mentions = {};\n      _this.editorInstance = options.editorInstance;\n      options.mentions.forEach(function (item) {\n        var marker = item.marker;\n\n        if (!marker) {\n          item.marker = marker = DEFAULT_MARKER;\n        }\n\n        var template = item.template;\n\n        if (template) {\n          var preparedTemplate = _this.editorInstance._getTemplate(template);\n\n          preparedTemplate && _mention2.default.addTemplate(marker, preparedTemplate);\n        }\n\n        _this._mentions[marker] = (0, _extend.extend)({}, _this._getDefaultOptions(), item);\n      });\n\n      _this._attachKeyboardHandlers();\n\n      _this.editorInstance.addCleanCallback(_this.clean.bind(_assertThisInitialized(_this)));\n\n      _this.quill.on(\"text-change\", _this.onTextChange.bind(_assertThisInitialized(_this)));\n\n      return _this;\n    }\n\n    _createClass(MentionModule, [{\n      key: \"_attachKeyboardHandlers\",\n      value: function value() {\n        var _this2 = this;\n\n        this.quill.keyboard.addBinding({\n          key: KEY_CODES.ARROW_UP\n        }, this._moveToItem.bind(this, \"prev\"));\n        this.quill.keyboard.addBinding({\n          key: KEY_CODES.ARROW_DOWN\n        }, this._moveToItem.bind(this, \"next\"));\n        this.quill.keyboard.addBinding({\n          key: KEY_CODES.ENTER\n        }, this._selectItemHandler.bind(this));\n        var enterBindings = this.quill.keyboard.bindings[KEY_CODES.ENTER];\n        enterBindings.unshift(enterBindings.pop());\n        this.quill.keyboard.addBinding({\n          key: KEY_CODES.ESCAPE\n        }, this._escapeKeyHandler.bind(this));\n        this.quill.keyboard.addBinding({\n          key: KEY_CODES.SPACE\n        }, this._selectItemHandler.bind(this));\n        this.quill.keyboard.addBinding({\n          key: KEY_CODES.ARROW_LEFT,\n          shiftKey: true\n        }, this._ignoreKeyHandler.bind(this));\n        this.quill.keyboard.addBinding({\n          key: KEY_CODES.ARROW_RIGHT,\n          shiftKey: true\n        }, this._ignoreKeyHandler.bind(this));\n        NAVIGATION_KEYS.forEach(function (key) {\n          _this2.quill.keyboard.addBinding({\n            key: key\n          }, _this2._ignoreKeyHandler.bind(_this2));\n        });\n      }\n    }, {\n      key: \"_moveToItem\",\n      value: function value(direction) {\n        var dataSource = this._list.getDataSource();\n\n        if (this._isMentionActive && !dataSource.isLoading()) {\n          var $focusedItem = (0, _renderer2.default)(this._list.option(\"focusedElement\"));\n          var defaultItemPosition = \"next\" === direction ? \"first\" : \"last\";\n          var $nextItem = $focusedItem[direction]();\n          $nextItem = $nextItem.length ? $nextItem : this._activeListItems[defaultItemPosition]();\n\n          this._list.option(\"focusedElement\", (0, _dom.getPublicElement)($nextItem));\n\n          this._list.scrollToItem($nextItem);\n        }\n\n        return !this._isMentionActive;\n      }\n    }, {\n      key: \"_ignoreKeyHandler\",\n      value: function value() {\n        return !this._isMentionActive;\n      }\n    }, {\n      key: \"_fitIntoRange\",\n      value: function value(_value, start, end) {\n        if (_value > end) {\n          return start;\n        }\n\n        if (_value < start) {\n          return end;\n        }\n\n        return _value;\n      }\n    }, {\n      key: \"_selectItemHandler\",\n      value: function value() {\n        if (this._isMentionActive) {\n          this._list.selectItem(this._list.option(\"focusedElement\"));\n        }\n\n        return !this._isMentionActive;\n      }\n    }, {\n      key: \"_escapeKeyHandler\",\n      value: function value() {\n        if (this._isMentionActive) {\n          this._popup.hide();\n        }\n\n        return !this._isMentionActive;\n      }\n    }, {\n      key: \"renderList\",\n      value: function value($container, options) {\n        this.compileGetters(this.options);\n\n        _get(_getPrototypeOf(MentionModule.prototype), \"renderList\", this).call(this, $container, options);\n      }\n    }, {\n      key: \"compileGetters\",\n      value: function value(_ref) {\n        var displayExpr = _ref.displayExpr,\n            valueExpr = _ref.valueExpr;\n        this._valueGetter = (0, _data.compileGetter)(displayExpr);\n        this._idGetter = (0, _data.compileGetter)(valueExpr);\n      }\n    }, {\n      key: \"_getListConfig\",\n      value: function value(options) {\n        var _this3 = this;\n\n        var baseConfig = _get(_getPrototypeOf(MentionModule.prototype), \"_getListConfig\", this).call(this, options);\n\n        return (0, _extend.extend)(baseConfig, {\n          itemTemplate: this.options.itemTemplate,\n          onContentReady: function onContentReady() {\n            if (_this3._hasSearch) {\n              _this3._popup.repaint();\n\n              _this3._focusFirstElement();\n\n              _this3._hasSearch = false;\n            }\n          }\n        });\n      }\n    }, {\n      key: \"insertEmbedContent\",\n      value: function value() {\n        var markerLength = this._activeMentionConfig.marker.length;\n        var textLength = markerLength + this._searchValue.length;\n        var caretPosition = this.getPosition();\n        var startIndex = Math.max(0, caretPosition - markerLength);\n\n        var selectedItem = this._list.option(\"selectedItem\");\n\n        var value = {\n          value: this._valueGetter(selectedItem),\n          id: this._idGetter(selectedItem),\n          marker: this._activeMentionConfig.marker\n        };\n        setTimeout(function () {\n          this.quill.insertText(startIndex, \" \", SILENT_ACTION);\n          this.quill.deleteText(startIndex + 1, textLength, SILENT_ACTION);\n          this.quill.insertEmbed(startIndex, \"mention\", value);\n          this.quill.setSelection(startIndex + 2);\n        }.bind(this));\n      }\n    }, {\n      key: \"_getLastInsertOperation\",\n      value: function value(ops) {\n        var lastOperation = ops[ops.length - 1];\n        var isLastOperationInsert = (\"insert\" in lastOperation);\n\n        if (isLastOperationInsert) {\n          return lastOperation;\n        }\n\n        var isLastOperationDelete = (\"delete\" in lastOperation);\n\n        if (isLastOperationDelete && ops.length >= 2) {\n          var penultOperation = ops[ops.length - 2];\n          var isPenultOperationInsert = (\"insert\" in penultOperation);\n          var isSelectionReplacing = isLastOperationDelete && isPenultOperationInsert;\n\n          if (isSelectionReplacing) {\n            return penultOperation;\n          }\n        }\n\n        return null;\n      }\n    }, {\n      key: \"onTextChange\",\n      value: function value(newDelta, oldDelta, source) {\n        if (source === USER_ACTION) {\n          var lastOperation = newDelta.ops[newDelta.ops.length - 1];\n\n          if (this._isMentionActive && this._isPopupVisible) {\n            this._processSearchValue(lastOperation) && this._filterList(this._searchValue);\n          } else {\n            var ops = newDelta.ops;\n\n            var lastInsertOperation = this._getLastInsertOperation(ops);\n\n            if (lastInsertOperation) {\n              this.checkMentionRequest(lastInsertOperation, ops);\n            }\n          }\n        }\n      }\n    }, {\n      key: \"_processSearchValue\",\n      value: function value(operation) {\n        var isInsertOperation = (\"insert\" in operation);\n\n        if (isInsertOperation) {\n          this._searchValue += operation.insert;\n        } else {\n          if (!this._searchValue.length || operation.delete > 1) {\n            this._popup.hide();\n\n            return false;\n          } else {\n            this._searchValue = this._searchValue.slice(0, -1);\n          }\n        }\n\n        return true;\n      }\n    }, {\n      key: \"checkMentionRequest\",\n      value: function value(_ref2, ops) {\n        var insert = _ref2.insert;\n        var caret = this.quill.getSelection();\n\n        if (!insert || !(0, _type.isString)(insert) || !caret || this._isMarkerPartOfText(ops[0].retain)) {\n          return;\n        }\n\n        this._activeMentionConfig = this._mentions[insert];\n\n        if (this._activeMentionConfig) {\n          this._updateList(this._activeMentionConfig);\n\n          this.savePosition(caret.index);\n\n          this._popup.option(\"position\", this._popupPosition);\n\n          this._searchValue = \"\";\n\n          this._popup.show();\n        }\n      }\n    }, {\n      key: \"_isMarkerPartOfText\",\n      value: function value(retain) {\n        if (!retain || ALLOWED_PREFIX_CHARS.indexOf(this._getCharByIndex(retain - 1)) !== -1) {\n          return false;\n        }\n\n        return true;\n      }\n    }, {\n      key: \"_getCharByIndex\",\n      value: function value(index) {\n        return this.quill.getContents(index, 1).ops[0].insert;\n      }\n    }, {\n      key: \"_updateList\",\n      value: function value(_ref3) {\n        var dataSource = _ref3.dataSource,\n            displayExpr = _ref3.displayExpr,\n            valueExpr = _ref3.valueExpr,\n            itemTemplate = _ref3.itemTemplate,\n            searchExpr = _ref3.searchExpr;\n        this.compileGetters({\n          displayExpr: displayExpr,\n          valueExpr: valueExpr\n        });\n\n        this._list.unselectAll();\n\n        this._list.option({\n          dataSource: dataSource,\n          displayExpr: displayExpr,\n          itemTemplate: itemTemplate,\n          searchExpr: searchExpr\n        });\n      }\n    }, {\n      key: \"_filterList\",\n      value: function value(searchValue) {\n        var _this4 = this;\n\n        if (!this._isMinSearchLengthExceeded(searchValue)) {\n          this._resetFilter();\n\n          return;\n        }\n\n        var searchTimeout = this._activeMentionConfig.searchTimeout;\n\n        if (searchTimeout) {\n          clearTimeout(this._searchTimer);\n          this._searchTimer = setTimeout(function () {\n            _this4._search(searchValue);\n          }, searchTimeout);\n        } else {\n          this._search(searchValue);\n        }\n      }\n    }, {\n      key: \"_isMinSearchLengthExceeded\",\n      value: function value(searchValue) {\n        return searchValue.length >= this._activeMentionConfig.minSearchLength;\n      }\n    }, {\n      key: \"_resetFilter\",\n      value: function value() {\n        clearTimeout(this._searchTimer);\n\n        this._search(null);\n      }\n    }, {\n      key: \"_search\",\n      value: function value(searchValue) {\n        this._hasSearch = true;\n\n        this._list.option(\"searchValue\", searchValue);\n      }\n    }, {\n      key: \"_focusFirstElement\",\n      value: function value() {\n        if (!this._list) {\n          return;\n        }\n\n        var $firstItem = this._activeListItems.first();\n\n        this._list.option(\"focusedElement\", (0, _dom.getPublicElement)($firstItem));\n\n        this._list.scrollToItem($firstItem);\n      }\n    }, {\n      key: \"_getPopupConfig\",\n      value: function value() {\n        var _this5 = this;\n\n        return (0, _extend.extend)(_get(_getPrototypeOf(MentionModule.prototype), \"_getPopupConfig\", this).call(this), {\n          closeOnTargetScroll: false,\n          onShown: function onShown() {\n            _this5._isMentionActive = true;\n            _this5._hasSearch = false;\n\n            _this5._focusFirstElement();\n          },\n          onHidden: function onHidden() {\n            _this5._list.unselectAll();\n\n            _this5._list.option(\"focusedElement\", null);\n\n            _this5._isMentionActive = false;\n\n            _this5._search(null);\n          },\n          focusStateEnabled: false\n        });\n      }\n    }, {\n      key: \"clean\",\n      value: function value() {\n        var _this6 = this;\n\n        Object.keys(this._mentions).forEach(function (marker) {\n          if (_this6._mentions[marker].template) {\n            _mention2.default.removeTemplate(marker);\n          }\n        });\n      }\n    }, {\n      key: \"_isPopupVisible\",\n      get: function get() {\n        var _this$_popup;\n\n        return null === (_this$_popup = this._popup) || void 0 === _this$_popup ? void 0 : _this$_popup.option(\"visible\");\n      }\n    }, {\n      key: \"_popupPosition\",\n      get: function get() {\n        var position = this.getPosition();\n\n        var _this$quill$getBounds = this.quill.getBounds(position ? position - 1 : position),\n            mentionLeft = _this$quill$getBounds.left,\n            mentionTop = _this$quill$getBounds.top,\n            mentionHeight = _this$quill$getBounds.height;\n\n        var _$$offset = (0, _renderer2.default)(this.quill.root).offset(),\n            leftOffset = _$$offset.left,\n            topOffset = _$$offset.top;\n\n        var positionEvent = (0, _events_engine.Event)(\"positionEvent\", {\n          pageX: leftOffset + mentionLeft,\n          pageY: topOffset + mentionTop\n        });\n        return {\n          of: positionEvent,\n          offset: {\n            v: mentionHeight\n          },\n          my: \"top left\",\n          at: \"top left\",\n          collision: {\n            y: \"flip\",\n            x: \"flipfit\"\n          }\n        };\n      }\n    }, {\n      key: \"_activeListItems\",\n      get: function get() {\n        return this._list.itemElements().filter(\":not(.\".concat(DISABLED_STATE_CLASS, \")\"));\n      }\n    }]);\n\n    return MentionModule;\n  }(_popup2.default);\n}\n\nexports.default = MentionModule;","map":{"version":3,"sources":["/Users/tracyvy/Desktop/UCB_Coding_Bootcamp/project_3/calendar/client/node_modules/devextreme/ui/html_editor/modules/mentions.js"],"names":["Object","defineProperty","exports","value","_renderer","require","_renderer2","_interopRequireDefault","_quill","_quill2","_data","_type","_extend","_dom","_events_engine","_popup","_popup2","_mention","_mention2","obj","__esModule","_typeof","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","result","Super","_getPrototypeOf","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","call","_assertThisInitialized","ReferenceError","sham","Proxy","Date","toString","e","_get","property","receiver","get","base","_superPropBase","desc","getOwnPropertyDescriptor","object","hasOwnProperty","getPrototypeOf","MentionModule","default","USER_ACTION","SILENT_ACTION","DEFAULT_MARKER","KEY_CODES","ARROW_UP","ARROW_DOWN","ARROW_LEFT","ARROW_RIGHT","ENTER","ESCAPE","SPACE","PAGE_UP","PAGE_DOWN","END","HOME","NAVIGATION_KEYS","ALLOWED_PREFIX_CHARS","DISABLED_STATE_CLASS","register","_PopupModule","_super","baseConfig","extend","itemTemplate","valueExpr","displayExpr","template","searchExpr","searchTimeout","minSearchLength","quill","options","_this","_mentions","editorInstance","mentions","forEach","item","marker","preparedTemplate","_getTemplate","addTemplate","_getDefaultOptions","_attachKeyboardHandlers","addCleanCallback","clean","bind","on","onTextChange","_this2","keyboard","addBinding","_moveToItem","_selectItemHandler","enterBindings","bindings","unshift","pop","_escapeKeyHandler","shiftKey","_ignoreKeyHandler","direction","dataSource","_list","getDataSource","_isMentionActive","isLoading","$focusedItem","option","defaultItemPosition","$nextItem","_activeListItems","getPublicElement","scrollToItem","start","end","selectItem","hide","$container","compileGetters","_ref","_valueGetter","compileGetter","_idGetter","_this3","onContentReady","_hasSearch","repaint","_focusFirstElement","markerLength","_activeMentionConfig","textLength","_searchValue","caretPosition","getPosition","startIndex","Math","max","selectedItem","id","setTimeout","insertText","deleteText","insertEmbed","setSelection","ops","lastOperation","isLastOperationInsert","isLastOperationDelete","penultOperation","isPenultOperationInsert","isSelectionReplacing","newDelta","oldDelta","source","_isPopupVisible","_processSearchValue","_filterList","lastInsertOperation","_getLastInsertOperation","checkMentionRequest","operation","isInsertOperation","insert","delete","slice","_ref2","caret","getSelection","isString","_isMarkerPartOfText","retain","_updateList","savePosition","index","_popupPosition","show","indexOf","_getCharByIndex","getContents","_ref3","unselectAll","searchValue","_this4","_isMinSearchLengthExceeded","_resetFilter","clearTimeout","_searchTimer","_search","$firstItem","first","_this5","closeOnTargetScroll","onShown","onHidden","focusStateEnabled","_this6","keys","removeTemplate","_this$_popup","position","_this$quill$getBounds","getBounds","mentionLeft","left","mentionTop","top","mentionHeight","height","_$$offset","root","offset","leftOffset","topOffset","positionEvent","Event","pageX","pageY","of","v","my","at","collision","y","x","itemElements","filter","concat"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/html_editor/modules/mentions.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\nvar _renderer = require(\"../../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _quill = require(\"quill\");\r\nvar _quill2 = _interopRequireDefault(_quill);\r\nvar _data = require(\"../../../core/utils/data\");\r\nvar _type = require(\"../../../core/utils/type\");\r\nvar _extend = require(\"../../../core/utils/extend\");\r\nvar _dom = require(\"../../../core/utils/dom\");\r\nvar _events_engine = require(\"../../../events/core/events_engine\");\r\nvar _popup = require(\"./popup\");\r\nvar _popup2 = _interopRequireDefault(_popup);\r\nvar _mention = require(\"../formats/mention\");\r\nvar _mention2 = _interopRequireDefault(_mention);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _typeof(obj) {\r\n    \"@babel/helpers - typeof\";\r\n    if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\r\n        _typeof = function(obj) {\r\n            return typeof obj\r\n        }\r\n    } else {\r\n        _typeof = function(obj) {\r\n            return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj\r\n        }\r\n    }\r\n    return _typeof(obj)\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\n\r\nfunction _inherits(subClass, superClass) {\r\n    if (\"function\" !== typeof superClass && null !== superClass) {\r\n        throw new TypeError(\"Super expression must either be null or a function\")\r\n    }\r\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\r\n        constructor: {\r\n            value: subClass,\r\n            writable: true,\r\n            configurable: true\r\n        }\r\n    });\r\n    if (superClass) {\r\n        _setPrototypeOf(subClass, superClass)\r\n    }\r\n}\r\n\r\nfunction _setPrototypeOf(o, p) {\r\n    _setPrototypeOf = Object.setPrototypeOf || function(o, p) {\r\n        o.__proto__ = p;\r\n        return o\r\n    };\r\n    return _setPrototypeOf(o, p)\r\n}\r\n\r\nfunction _createSuper(Derived) {\r\n    var hasNativeReflectConstruct = _isNativeReflectConstruct();\r\n    return function() {\r\n        var result, Super = _getPrototypeOf(Derived);\r\n        if (hasNativeReflectConstruct) {\r\n            var NewTarget = _getPrototypeOf(this).constructor;\r\n            result = Reflect.construct(Super, arguments, NewTarget)\r\n        } else {\r\n            result = Super.apply(this, arguments)\r\n        }\r\n        return _possibleConstructorReturn(this, result)\r\n    }\r\n}\r\n\r\nfunction _possibleConstructorReturn(self, call) {\r\n    if (call && (\"object\" === _typeof(call) || \"function\" === typeof call)) {\r\n        return call\r\n    }\r\n    return _assertThisInitialized(self)\r\n}\r\n\r\nfunction _assertThisInitialized(self) {\r\n    if (void 0 === self) {\r\n        throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\")\r\n    }\r\n    return self\r\n}\r\n\r\nfunction _isNativeReflectConstruct() {\r\n    if (\"undefined\" === typeof Reflect || !Reflect.construct) {\r\n        return false\r\n    }\r\n    if (Reflect.construct.sham) {\r\n        return false\r\n    }\r\n    if (\"function\" === typeof Proxy) {\r\n        return true\r\n    }\r\n    try {\r\n        Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\r\n        return true\r\n    } catch (e) {\r\n        return false\r\n    }\r\n}\r\n\r\nfunction _get(target, property, receiver) {\r\n    if (\"undefined\" !== typeof Reflect && Reflect.get) {\r\n        _get = Reflect.get\r\n    } else {\r\n        _get = function(target, property, receiver) {\r\n            var base = _superPropBase(target, property);\r\n            if (!base) {\r\n                return\r\n            }\r\n            var desc = Object.getOwnPropertyDescriptor(base, property);\r\n            if (desc.get) {\r\n                return desc.get.call(receiver)\r\n            }\r\n            return desc.value\r\n        }\r\n    }\r\n    return _get(target, property, receiver || target)\r\n}\r\n\r\nfunction _superPropBase(object, property) {\r\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\r\n        object = _getPrototypeOf(object);\r\n        if (null === object) {\r\n            break\r\n        }\r\n    }\r\n    return object\r\n}\r\n\r\nfunction _getPrototypeOf(o) {\r\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function(o) {\r\n        return o.__proto__ || Object.getPrototypeOf(o)\r\n    };\r\n    return _getPrototypeOf(o)\r\n}\r\nvar MentionModule = {};\r\nif (_quill2.default) {\r\n    var USER_ACTION = \"user\";\r\n    var SILENT_ACTION = \"silent\";\r\n    var DEFAULT_MARKER = \"@\";\r\n    var KEY_CODES = {\r\n        ARROW_UP: 38,\r\n        ARROW_DOWN: 40,\r\n        ARROW_LEFT: 37,\r\n        ARROW_RIGHT: 39,\r\n        ENTER: 13,\r\n        ESCAPE: 27,\r\n        SPACE: 32,\r\n        PAGE_UP: 33,\r\n        PAGE_DOWN: 34,\r\n        END: 35,\r\n        HOME: 36\r\n    };\r\n    var NAVIGATION_KEYS = [KEY_CODES.ARROW_LEFT, KEY_CODES.ARROW_RIGHT, KEY_CODES.PAGE_UP, KEY_CODES.PAGE_DOWN, KEY_CODES.END, KEY_CODES.HOME];\r\n    var ALLOWED_PREFIX_CHARS = [\" \", \"\\n\"];\r\n    var DISABLED_STATE_CLASS = \"dx-state-disabled\";\r\n    _quill2.default.register({\r\n        \"formats/mention\": _mention2.default\r\n    }, true);\r\n    MentionModule = function(_PopupModule) {\r\n        _inherits(MentionModule, _PopupModule);\r\n        var _super = _createSuper(MentionModule);\r\n        _createClass(MentionModule, [{\r\n            key: \"_getDefaultOptions\",\r\n            value: function() {\r\n                var baseConfig = _get(_getPrototypeOf(MentionModule.prototype), \"_getDefaultOptions\", this).call(this);\r\n                return (0, _extend.extend)(baseConfig, {\r\n                    itemTemplate: \"item\",\r\n                    valueExpr: \"this\",\r\n                    displayExpr: \"this\",\r\n                    template: null,\r\n                    searchExpr: null,\r\n                    searchTimeout: 500,\r\n                    minSearchLength: 0\r\n                })\r\n            }\r\n        }]);\r\n\r\n        function MentionModule(quill, options) {\r\n            var _this;\r\n            _classCallCheck(this, MentionModule);\r\n            _this = _super.call(this, quill, options);\r\n            _this._mentions = {};\r\n            _this.editorInstance = options.editorInstance;\r\n            options.mentions.forEach(function(item) {\r\n                var marker = item.marker;\r\n                if (!marker) {\r\n                    item.marker = marker = DEFAULT_MARKER\r\n                }\r\n                var template = item.template;\r\n                if (template) {\r\n                    var preparedTemplate = _this.editorInstance._getTemplate(template);\r\n                    preparedTemplate && _mention2.default.addTemplate(marker, preparedTemplate)\r\n                }\r\n                _this._mentions[marker] = (0, _extend.extend)({}, _this._getDefaultOptions(), item)\r\n            });\r\n            _this._attachKeyboardHandlers();\r\n            _this.editorInstance.addCleanCallback(_this.clean.bind(_assertThisInitialized(_this)));\r\n            _this.quill.on(\"text-change\", _this.onTextChange.bind(_assertThisInitialized(_this)));\r\n            return _this\r\n        }\r\n        _createClass(MentionModule, [{\r\n            key: \"_attachKeyboardHandlers\",\r\n            value: function() {\r\n                var _this2 = this;\r\n                this.quill.keyboard.addBinding({\r\n                    key: KEY_CODES.ARROW_UP\r\n                }, this._moveToItem.bind(this, \"prev\"));\r\n                this.quill.keyboard.addBinding({\r\n                    key: KEY_CODES.ARROW_DOWN\r\n                }, this._moveToItem.bind(this, \"next\"));\r\n                this.quill.keyboard.addBinding({\r\n                    key: KEY_CODES.ENTER\r\n                }, this._selectItemHandler.bind(this));\r\n                var enterBindings = this.quill.keyboard.bindings[KEY_CODES.ENTER];\r\n                enterBindings.unshift(enterBindings.pop());\r\n                this.quill.keyboard.addBinding({\r\n                    key: KEY_CODES.ESCAPE\r\n                }, this._escapeKeyHandler.bind(this));\r\n                this.quill.keyboard.addBinding({\r\n                    key: KEY_CODES.SPACE\r\n                }, this._selectItemHandler.bind(this));\r\n                this.quill.keyboard.addBinding({\r\n                    key: KEY_CODES.ARROW_LEFT,\r\n                    shiftKey: true\r\n                }, this._ignoreKeyHandler.bind(this));\r\n                this.quill.keyboard.addBinding({\r\n                    key: KEY_CODES.ARROW_RIGHT,\r\n                    shiftKey: true\r\n                }, this._ignoreKeyHandler.bind(this));\r\n                NAVIGATION_KEYS.forEach(function(key) {\r\n                    _this2.quill.keyboard.addBinding({\r\n                        key: key\r\n                    }, _this2._ignoreKeyHandler.bind(_this2))\r\n                })\r\n            }\r\n        }, {\r\n            key: \"_moveToItem\",\r\n            value: function(direction) {\r\n                var dataSource = this._list.getDataSource();\r\n                if (this._isMentionActive && !dataSource.isLoading()) {\r\n                    var $focusedItem = (0, _renderer2.default)(this._list.option(\"focusedElement\"));\r\n                    var defaultItemPosition = \"next\" === direction ? \"first\" : \"last\";\r\n                    var $nextItem = $focusedItem[direction]();\r\n                    $nextItem = $nextItem.length ? $nextItem : this._activeListItems[defaultItemPosition]();\r\n                    this._list.option(\"focusedElement\", (0, _dom.getPublicElement)($nextItem));\r\n                    this._list.scrollToItem($nextItem)\r\n                }\r\n                return !this._isMentionActive\r\n            }\r\n        }, {\r\n            key: \"_ignoreKeyHandler\",\r\n            value: function() {\r\n                return !this._isMentionActive\r\n            }\r\n        }, {\r\n            key: \"_fitIntoRange\",\r\n            value: function(value, start, end) {\r\n                if (value > end) {\r\n                    return start\r\n                }\r\n                if (value < start) {\r\n                    return end\r\n                }\r\n                return value\r\n            }\r\n        }, {\r\n            key: \"_selectItemHandler\",\r\n            value: function() {\r\n                if (this._isMentionActive) {\r\n                    this._list.selectItem(this._list.option(\"focusedElement\"))\r\n                }\r\n                return !this._isMentionActive\r\n            }\r\n        }, {\r\n            key: \"_escapeKeyHandler\",\r\n            value: function() {\r\n                if (this._isMentionActive) {\r\n                    this._popup.hide()\r\n                }\r\n                return !this._isMentionActive\r\n            }\r\n        }, {\r\n            key: \"renderList\",\r\n            value: function($container, options) {\r\n                this.compileGetters(this.options);\r\n                _get(_getPrototypeOf(MentionModule.prototype), \"renderList\", this).call(this, $container, options)\r\n            }\r\n        }, {\r\n            key: \"compileGetters\",\r\n            value: function(_ref) {\r\n                var displayExpr = _ref.displayExpr,\r\n                    valueExpr = _ref.valueExpr;\r\n                this._valueGetter = (0, _data.compileGetter)(displayExpr);\r\n                this._idGetter = (0, _data.compileGetter)(valueExpr)\r\n            }\r\n        }, {\r\n            key: \"_getListConfig\",\r\n            value: function(options) {\r\n                var _this3 = this;\r\n                var baseConfig = _get(_getPrototypeOf(MentionModule.prototype), \"_getListConfig\", this).call(this, options);\r\n                return (0, _extend.extend)(baseConfig, {\r\n                    itemTemplate: this.options.itemTemplate,\r\n                    onContentReady: function() {\r\n                        if (_this3._hasSearch) {\r\n                            _this3._popup.repaint();\r\n                            _this3._focusFirstElement();\r\n                            _this3._hasSearch = false\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n        }, {\r\n            key: \"insertEmbedContent\",\r\n            value: function() {\r\n                var markerLength = this._activeMentionConfig.marker.length;\r\n                var textLength = markerLength + this._searchValue.length;\r\n                var caretPosition = this.getPosition();\r\n                var startIndex = Math.max(0, caretPosition - markerLength);\r\n                var selectedItem = this._list.option(\"selectedItem\");\r\n                var value = {\r\n                    value: this._valueGetter(selectedItem),\r\n                    id: this._idGetter(selectedItem),\r\n                    marker: this._activeMentionConfig.marker\r\n                };\r\n                setTimeout(function() {\r\n                    this.quill.insertText(startIndex, \" \", SILENT_ACTION);\r\n                    this.quill.deleteText(startIndex + 1, textLength, SILENT_ACTION);\r\n                    this.quill.insertEmbed(startIndex, \"mention\", value);\r\n                    this.quill.setSelection(startIndex + 2)\r\n                }.bind(this))\r\n            }\r\n        }, {\r\n            key: \"_getLastInsertOperation\",\r\n            value: function(ops) {\r\n                var lastOperation = ops[ops.length - 1];\r\n                var isLastOperationInsert = \"insert\" in lastOperation;\r\n                if (isLastOperationInsert) {\r\n                    return lastOperation\r\n                }\r\n                var isLastOperationDelete = \"delete\" in lastOperation;\r\n                if (isLastOperationDelete && ops.length >= 2) {\r\n                    var penultOperation = ops[ops.length - 2];\r\n                    var isPenultOperationInsert = \"insert\" in penultOperation;\r\n                    var isSelectionReplacing = isLastOperationDelete && isPenultOperationInsert;\r\n                    if (isSelectionReplacing) {\r\n                        return penultOperation\r\n                    }\r\n                }\r\n                return null\r\n            }\r\n        }, {\r\n            key: \"onTextChange\",\r\n            value: function(newDelta, oldDelta, source) {\r\n                if (source === USER_ACTION) {\r\n                    var lastOperation = newDelta.ops[newDelta.ops.length - 1];\r\n                    if (this._isMentionActive && this._isPopupVisible) {\r\n                        this._processSearchValue(lastOperation) && this._filterList(this._searchValue)\r\n                    } else {\r\n                        var ops = newDelta.ops;\r\n                        var lastInsertOperation = this._getLastInsertOperation(ops);\r\n                        if (lastInsertOperation) {\r\n                            this.checkMentionRequest(lastInsertOperation, ops)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }, {\r\n            key: \"_processSearchValue\",\r\n            value: function(operation) {\r\n                var isInsertOperation = \"insert\" in operation;\r\n                if (isInsertOperation) {\r\n                    this._searchValue += operation.insert\r\n                } else {\r\n                    if (!this._searchValue.length || operation.delete > 1) {\r\n                        this._popup.hide();\r\n                        return false\r\n                    } else {\r\n                        this._searchValue = this._searchValue.slice(0, -1)\r\n                    }\r\n                }\r\n                return true\r\n            }\r\n        }, {\r\n            key: \"checkMentionRequest\",\r\n            value: function(_ref2, ops) {\r\n                var insert = _ref2.insert;\r\n                var caret = this.quill.getSelection();\r\n                if (!insert || !(0, _type.isString)(insert) || !caret || this._isMarkerPartOfText(ops[0].retain)) {\r\n                    return\r\n                }\r\n                this._activeMentionConfig = this._mentions[insert];\r\n                if (this._activeMentionConfig) {\r\n                    this._updateList(this._activeMentionConfig);\r\n                    this.savePosition(caret.index);\r\n                    this._popup.option(\"position\", this._popupPosition);\r\n                    this._searchValue = \"\";\r\n                    this._popup.show()\r\n                }\r\n            }\r\n        }, {\r\n            key: \"_isMarkerPartOfText\",\r\n            value: function(retain) {\r\n                if (!retain || ALLOWED_PREFIX_CHARS.indexOf(this._getCharByIndex(retain - 1)) !== -1) {\r\n                    return false\r\n                }\r\n                return true\r\n            }\r\n        }, {\r\n            key: \"_getCharByIndex\",\r\n            value: function(index) {\r\n                return this.quill.getContents(index, 1).ops[0].insert\r\n            }\r\n        }, {\r\n            key: \"_updateList\",\r\n            value: function(_ref3) {\r\n                var dataSource = _ref3.dataSource,\r\n                    displayExpr = _ref3.displayExpr,\r\n                    valueExpr = _ref3.valueExpr,\r\n                    itemTemplate = _ref3.itemTemplate,\r\n                    searchExpr = _ref3.searchExpr;\r\n                this.compileGetters({\r\n                    displayExpr: displayExpr,\r\n                    valueExpr: valueExpr\r\n                });\r\n                this._list.unselectAll();\r\n                this._list.option({\r\n                    dataSource: dataSource,\r\n                    displayExpr: displayExpr,\r\n                    itemTemplate: itemTemplate,\r\n                    searchExpr: searchExpr\r\n                })\r\n            }\r\n        }, {\r\n            key: \"_filterList\",\r\n            value: function(searchValue) {\r\n                var _this4 = this;\r\n                if (!this._isMinSearchLengthExceeded(searchValue)) {\r\n                    this._resetFilter();\r\n                    return\r\n                }\r\n                var searchTimeout = this._activeMentionConfig.searchTimeout;\r\n                if (searchTimeout) {\r\n                    clearTimeout(this._searchTimer);\r\n                    this._searchTimer = setTimeout(function() {\r\n                        _this4._search(searchValue)\r\n                    }, searchTimeout)\r\n                } else {\r\n                    this._search(searchValue)\r\n                }\r\n            }\r\n        }, {\r\n            key: \"_isMinSearchLengthExceeded\",\r\n            value: function(searchValue) {\r\n                return searchValue.length >= this._activeMentionConfig.minSearchLength\r\n            }\r\n        }, {\r\n            key: \"_resetFilter\",\r\n            value: function() {\r\n                clearTimeout(this._searchTimer);\r\n                this._search(null)\r\n            }\r\n        }, {\r\n            key: \"_search\",\r\n            value: function(searchValue) {\r\n                this._hasSearch = true;\r\n                this._list.option(\"searchValue\", searchValue)\r\n            }\r\n        }, {\r\n            key: \"_focusFirstElement\",\r\n            value: function() {\r\n                if (!this._list) {\r\n                    return\r\n                }\r\n                var $firstItem = this._activeListItems.first();\r\n                this._list.option(\"focusedElement\", (0, _dom.getPublicElement)($firstItem));\r\n                this._list.scrollToItem($firstItem)\r\n            }\r\n        }, {\r\n            key: \"_getPopupConfig\",\r\n            value: function() {\r\n                var _this5 = this;\r\n                return (0, _extend.extend)(_get(_getPrototypeOf(MentionModule.prototype), \"_getPopupConfig\", this).call(this), {\r\n                    closeOnTargetScroll: false,\r\n                    onShown: function() {\r\n                        _this5._isMentionActive = true;\r\n                        _this5._hasSearch = false;\r\n                        _this5._focusFirstElement()\r\n                    },\r\n                    onHidden: function() {\r\n                        _this5._list.unselectAll();\r\n                        _this5._list.option(\"focusedElement\", null);\r\n                        _this5._isMentionActive = false;\r\n                        _this5._search(null)\r\n                    },\r\n                    focusStateEnabled: false\r\n                })\r\n            }\r\n        }, {\r\n            key: \"clean\",\r\n            value: function() {\r\n                var _this6 = this;\r\n                Object.keys(this._mentions).forEach(function(marker) {\r\n                    if (_this6._mentions[marker].template) {\r\n                        _mention2.default.removeTemplate(marker)\r\n                    }\r\n                })\r\n            }\r\n        }, {\r\n            key: \"_isPopupVisible\",\r\n            get: function() {\r\n                var _this$_popup;\r\n                return null === (_this$_popup = this._popup) || void 0 === _this$_popup ? void 0 : _this$_popup.option(\"visible\")\r\n            }\r\n        }, {\r\n            key: \"_popupPosition\",\r\n            get: function() {\r\n                var position = this.getPosition();\r\n                var _this$quill$getBounds = this.quill.getBounds(position ? position - 1 : position),\r\n                    mentionLeft = _this$quill$getBounds.left,\r\n                    mentionTop = _this$quill$getBounds.top,\r\n                    mentionHeight = _this$quill$getBounds.height;\r\n                var _$$offset = (0, _renderer2.default)(this.quill.root).offset(),\r\n                    leftOffset = _$$offset.left,\r\n                    topOffset = _$$offset.top;\r\n                var positionEvent = (0, _events_engine.Event)(\"positionEvent\", {\r\n                    pageX: leftOffset + mentionLeft,\r\n                    pageY: topOffset + mentionTop\r\n                });\r\n                return {\r\n                    of: positionEvent,\r\n                    offset: {\r\n                        v: mentionHeight\r\n                    },\r\n                    my: \"top left\",\r\n                    at: \"top left\",\r\n                    collision: {\r\n                        y: \"flip\",\r\n                        x: \"flipfit\"\r\n                    }\r\n                }\r\n            }\r\n        }, {\r\n            key: \"_activeListItems\",\r\n            get: function() {\r\n                return this._list.itemElements().filter(\":not(.\".concat(DISABLED_STATE_CLASS, \")\"))\r\n            }\r\n        }]);\r\n        return MentionModule\r\n    }(_popup2.default)\r\n}\r\nexports.default = MentionModule;\r\n"]},"metadata":{},"sourceType":"script"}