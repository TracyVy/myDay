{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointments.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _dom_adapter = require(\"../../core/dom_adapter\");\n\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _element_data = require(\"../../core/element_data\");\n\nvar _element_data2 = _interopRequireDefault(_element_data);\n\nvar _translator = require(\"../../animation/translator\");\n\nvar _translator2 = _interopRequireDefault(_translator);\n\nvar _date = require(\"../../core/utils/date\");\n\nvar _date2 = _interopRequireDefault(_date);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _common2 = _interopRequireDefault(_common);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _type2 = _interopRequireDefault(_type);\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _object = require(\"../../core/utils/object\");\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _array = require(\"../../core/utils/array\");\n\nvar _array2 = _interopRequireDefault(_array);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _dom = require(\"../../core/utils/dom\");\n\nvar _utils = require(\"./utils.recurrence\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _uiScheduler = require(\"./ui.scheduler.publisher_mixin\");\n\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\n\nvar _uiScheduler3 = require(\"./ui.scheduler.appointment\");\n\nvar _uiScheduler4 = _interopRequireDefault(_uiScheduler3);\n\nvar _utils3 = require(\"../../events/utils\");\n\nvar eventUtils = _interopRequireWildcard(_utils3);\n\nvar _double_click = require(\"../../events/double_click\");\n\nvar _double_click2 = _interopRequireDefault(_double_click);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _uiCollection_widget = require(\"../collection/ui.collection_widget.edit\");\n\nvar _uiCollection_widget2 = _interopRequireDefault(_uiCollection_widget);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _utilsTimeZone = require(\"./utils.timeZone.js\");\n\nvar _utilsTimeZone2 = _interopRequireDefault(_utilsTimeZone);\n\nfunction _getRequireWildcardCache() {\n  if (\"function\" !== typeof WeakMap) {\n    return null;\n  }\n\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function () {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (null === obj || \"object\" !== _typeof(obj) && \"function\" !== typeof obj) {\n    return {\n      \"default\": obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar APPOINTMENT_SETTINGS_NAME = \"dxAppointmentSettings\";\nvar COMPONENT_CLASS = \"dx-scheduler-scrollable-appointments\";\nvar APPOINTMENT_ITEM_CLASS = \"dx-scheduler-appointment\";\nvar APPOINTMENT_TITLE_CLASS = \"dx-scheduler-appointment-title\";\nvar APPOINTMENT_CONTENT_DETAILS_CLASS = \"dx-scheduler-appointment-content-details\";\nvar APPOINTMENT_DATE_CLASS = \"dx-scheduler-appointment-content-date\";\nvar RECURRING_ICON_CLASS = \"dx-scheduler-appointment-recurrence-icon\";\nvar ALL_DAY_CONTENT_CLASS = \"dx-scheduler-appointment-content-allday\";\nvar DBLCLICK_EVENT_NAME = eventUtils.addNamespace(_double_click2.default.name, \"dxSchedulerAppointment\");\nvar toMs = _date2.default.dateToMilliseconds;\n\nvar SchedulerAppointments = _uiCollection_widget2.default.inherit({\n  ctor: function (element, options) {\n    this.callBase(element, options);\n  },\n  _supportedKeys: function () {\n    var parent = this.callBase();\n\n    var tabHandler = function (e) {\n      var appointments = this._getAccessAppointments();\n\n      var focusedAppointment = appointments.filter(\".dx-state-focused\");\n      var index = focusedAppointment.data(APPOINTMENT_SETTINGS_NAME).sortedIndex;\n      var lastIndex = appointments.length - 1;\n\n      if (index > 0 && e.shiftKey || index < lastIndex && !e.shiftKey) {\n        e.preventDefault();\n        e.shiftKey ? index-- : index++;\n\n        var $nextAppointment = this._getAppointmentByIndex(index);\n\n        this._resetTabIndex($nextAppointment);\n\n        _events_engine2.default.trigger($nextAppointment, \"focus\");\n      }\n    };\n\n    return (0, _extend.extend)(parent, {\n      escape: function () {\n        this.moveAppointmentBack();\n        this._escPressed = true;\n      }.bind(this),\n      del: function (e) {\n        if (this.option(\"allowDelete\")) {\n          e.preventDefault();\n\n          var data = this._getItemData(e.target);\n\n          this.notifyObserver(\"deleteAppointment\", {\n            data: data,\n            target: e.target\n          });\n          this.notifyObserver(\"hideAppointmentTooltip\");\n        }\n      }.bind(this),\n      tab: tabHandler\n    });\n  },\n  _getAppointmentByIndex: function (sortedIndex) {\n    var appointments = this._getAccessAppointments();\n\n    return appointments.filter(function (_, $item) {\n      return _element_data2.default.data($item, APPOINTMENT_SETTINGS_NAME).sortedIndex === sortedIndex;\n    }).eq(0);\n  },\n  _getAccessAppointments: function () {\n    return this._itemElements().filter(\":visible\").not(\".dx-state-disabled\");\n  },\n  _resetTabIndex: function ($appointment) {\n    this._focusTarget().attr(\"tabIndex\", -1);\n\n    $appointment.attr(\"tabIndex\", this.option(\"tabIndex\"));\n  },\n  _moveFocus: _common2.default.noop,\n  _focusTarget: function () {\n    return this._itemElements();\n  },\n  _renderFocusTarget: function () {\n    var $appointment = this._getAppointmentByIndex(0);\n\n    this._resetTabIndex($appointment);\n  },\n  _focusInHandler: function (e) {\n    this.callBase.apply(this, arguments);\n    this._$currentAppointment = (0, _renderer2.default)(e.target);\n    this.option(\"focusedElement\", (0, _dom.getPublicElement)((0, _renderer2.default)(e.target)));\n  },\n  _focusOutHandler: function () {\n    var $appointment = this._getAppointmentByIndex(0);\n\n    this.option(\"focusedElement\", (0, _dom.getPublicElement)($appointment));\n    this.callBase.apply(this, arguments);\n  },\n  _eventBindingTarget: function () {\n    return this._itemContainer();\n  },\n  _getDefaultOptions: function () {\n    return (0, _extend.extend)(this.callBase(), {\n      noDataText: null,\n      activeStateEnabled: true,\n      hoverStateEnabled: true,\n      tabIndex: 0,\n      fixedContainer: null,\n      allDayContainer: null,\n      allowDrag: true,\n      allowResize: true,\n      allowAllDayResize: true,\n      onAppointmentDblClick: null,\n      _collectorOffset: 0\n    });\n  },\n  _optionChanged: function (args) {\n    switch (args.name) {\n      case \"items\":\n        this._cleanFocusState();\n\n        this._clearDropDownItems();\n\n        this._clearDropDownItemsElements();\n\n        this._repaintAppointments(args.value);\n\n        this._renderDropDownAppointments();\n\n        this._attachAppointmentsEvents();\n\n        break;\n\n      case \"fixedContainer\":\n      case \"allDayContainer\":\n      case \"onAppointmentDblClick\":\n        break;\n\n      case \"allowDrag\":\n      case \"allowResize\":\n      case \"allowAllDayResize\":\n        this._invalidate();\n\n        break;\n\n      case \"focusedElement\":\n        this._resetTabIndex((0, _renderer2.default)(args.value));\n\n        this.callBase(args);\n        break;\n\n      case \"allowDelete\":\n        break;\n\n      case \"focusStateEnabled\":\n        this._clearDropDownItemsElements();\n\n        this._renderDropDownAppointments();\n\n        this.callBase(args);\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _isAllDayAppointment: function (appointment) {\n    return appointment.settings.length && appointment.settings[0].allDay || false;\n  },\n  _isRepaintAppointment: function (appointment) {\n    return !_type2.default.isDefined(appointment.needRepaint) || true === appointment.needRepaint;\n  },\n  _isRepaintAll: function (appointments) {\n    if (this.invoke(\"isCurrentViewAgenda\")) {\n      return true;\n    }\n\n    for (var i = 0; i < appointments.length; i++) {\n      var appointment = appointments[i];\n\n      if (!this._isRepaintAppointment(appointment)) {\n        return false;\n      }\n    }\n\n    return true;\n  },\n  _applyFragment: function (fragment, allDay) {\n    if (fragment.children().length > 0) {\n      this._getAppointmentContainer(allDay).append(fragment);\n    }\n  },\n  _onEachAppointment: function (appointment, index, container, isRepaintAll) {\n    if (appointment && true === appointment.needRemove) {\n      this._clearItem(appointment);\n\n      return;\n    }\n\n    if (this._isRepaintAppointment(appointment)) {\n      appointment.needRepaint = false;\n      !isRepaintAll && this._clearItem(appointment);\n\n      this._renderItem(index, appointment, container);\n    }\n  },\n  _repaintAppointments: function (appointments) {\n    var _this = this;\n\n    var isRepaintAll = this._isRepaintAll(appointments);\n\n    var allDayFragment = (0, _renderer2.default)(this._getAppointmentContainer(true));\n    var commonFragment = (0, _renderer2.default)(this._getAppointmentContainer(false));\n\n    if (isRepaintAll) {\n      this._getAppointmentContainer(true).html(\"\");\n\n      this._getAppointmentContainer(false).html(\"\");\n    }\n\n    !appointments.length && this._cleanItemContainer();\n    appointments.forEach(function (appointment, index) {\n      var container = _this._isAllDayAppointment(appointment) ? allDayFragment : commonFragment;\n\n      _this._onEachAppointment(appointment, index, container, isRepaintAll);\n    });\n\n    this._applyFragment(allDayFragment, true);\n\n    this._applyFragment(commonFragment, false);\n  },\n  _attachAppointmentsEvents: function () {\n    this._attachClickEvent();\n\n    this._attachHoldEvent();\n\n    this._attachContextMenuEvent();\n\n    this._attachAppointmentDblClick();\n\n    this._renderFocusState();\n\n    this._attachFeedbackEvents();\n\n    this._attachHoverEvents();\n  },\n  _clearItem: function (item) {\n    var $items = this._findItemElementByItem(item.itemData);\n\n    if (!$items.length) {\n      return;\n    }\n\n    (0, _iterator.each)($items, function (_, $item) {\n      $item.detach();\n      $item.remove();\n    });\n  },\n  _clearDropDownItems: function () {\n    this._virtualAppointments = {};\n  },\n  _clearDropDownItemsElements: function () {\n    this.invoke(\"clearCompactAppointments\");\n  },\n  _findItemElementByItem: function (item) {\n    var result = [];\n    var that = this;\n    this.itemElements().each(function () {\n      var $item = (0, _renderer2.default)(this);\n\n      if ($item.data(that._itemDataKey()) === item) {\n        result.push($item);\n      }\n    });\n    return result;\n  },\n  _itemClass: function () {\n    return APPOINTMENT_ITEM_CLASS;\n  },\n  _itemContainer: function () {\n    var $container = this.callBase();\n    var $result = $container;\n    var $allDayContainer = this.option(\"allDayContainer\");\n\n    if ($allDayContainer) {\n      $result = $container.add($allDayContainer);\n    }\n\n    return $result;\n  },\n  _cleanItemContainer: function () {\n    this.callBase();\n    var $allDayContainer = this.option(\"allDayContainer\");\n\n    if ($allDayContainer) {\n      $allDayContainer.empty();\n    }\n\n    this._virtualAppointments = {};\n  },\n  _clean: function () {\n    this.callBase();\n    delete this._$currentAppointment;\n    delete this._initialSize;\n    delete this._initialCoordinates;\n  },\n  _init: function () {\n    this.callBase();\n    this.$element().addClass(COMPONENT_CLASS);\n    this._preventSingleAppointmentClick = false;\n  },\n  _renderAppointmentTemplate: function ($container, data, model) {\n    var formatText = this.invoke(\"getTextAndFormatDate\", model.appointmentData, model.appointmentData.settings || model.targetedAppointmentData || {}, \"TIME\");\n    (0, _renderer2.default)(\"<div>\").text(formatText.text).addClass(APPOINTMENT_TITLE_CLASS).appendTo($container);\n\n    if (_type2.default.isPlainObject(data)) {\n      if (data.html) {\n        $container.html(data.html);\n      }\n    }\n\n    var $contentDetails = (0, _renderer2.default)(\"<div>\").addClass(APPOINTMENT_CONTENT_DETAILS_CLASS);\n    (0, _renderer2.default)(\"<div>\").addClass(APPOINTMENT_DATE_CLASS).text(formatText.formatDate).appendTo($contentDetails);\n    $contentDetails.appendTo($container);\n\n    if (data.recurrenceRule) {\n      (0, _renderer2.default)(\"<span>\").addClass(RECURRING_ICON_CLASS + \" dx-icon-repeat\").appendTo($container);\n    }\n\n    if (data.allDay) {\n      (0, _renderer2.default)(\"<div>\").text(\" \" + _message2.default.format(\"dxScheduler-allDay\") + \": \").addClass(ALL_DAY_CONTENT_CLASS).prependTo($contentDetails);\n    }\n  },\n  _executeItemRenderAction: function (index, itemData, itemElement) {\n    var action = this._getItemRenderAction();\n\n    if (action) {\n      action(this.invoke(\"mapAppointmentFields\", {\n        itemData: itemData,\n        itemElement: itemElement\n      }));\n    }\n\n    delete this._currentAppointmentSettings;\n  },\n  _itemClickHandler: function (e) {\n    this.callBase(e, {}, {\n      afterExecute: function (e) {\n        this._processItemClick(e.args[0].event);\n      }.bind(this)\n    });\n  },\n  _processItemClick: function (e) {\n    var $target = (0, _renderer2.default)(e.currentTarget);\n\n    var data = this._getItemData($target);\n\n    if (\"keydown\" === e.type || eventUtils.isFakeClickEvent(e)) {\n      this.notifyObserver(\"showEditAppointmentPopup\", {\n        data: data,\n        target: $target\n      });\n      return;\n    }\n\n    this._appointmentClickTimeout = setTimeout(function () {\n      if (!this._preventSingleAppointmentClick && _dom_adapter2.default.getBody().contains($target[0])) {\n        this.notifyObserver(\"showAppointmentTooltip\", {\n          data: data,\n          target: $target\n        });\n      }\n\n      this._preventSingleAppointmentClick = false;\n    }.bind(this), 300);\n  },\n  _extendActionArgs: function () {\n    var args = this.callBase.apply(this, arguments);\n    return this.invoke(\"mapAppointmentFields\", args);\n  },\n  _render: function () {\n    this.callBase.apply(this, arguments);\n\n    this._attachAppointmentDblClick();\n  },\n  _attachAppointmentDblClick: function () {\n    var that = this;\n\n    var itemSelector = that._itemSelector();\n\n    var itemContainer = this._itemContainer();\n\n    _events_engine2.default.off(itemContainer, DBLCLICK_EVENT_NAME, itemSelector);\n\n    _events_engine2.default.on(itemContainer, DBLCLICK_EVENT_NAME, itemSelector, function (e) {\n      that._itemDXEventHandler(e, \"onAppointmentDblClick\", {}, {\n        afterExecute: function (e) {\n          that._dblClickHandler(e.args[0].event);\n        }\n      });\n    });\n  },\n  _dblClickHandler: function (e) {\n    var $targetAppointment = (0, _renderer2.default)(e.currentTarget);\n\n    var appointmentData = this._getItemData($targetAppointment);\n\n    clearTimeout(this._appointmentClickTimeout);\n    this._preventSingleAppointmentClick = true;\n    this.notifyObserver(\"showEditAppointmentPopup\", {\n      data: appointmentData,\n      target: $targetAppointment\n    });\n  },\n  _renderItem: function (index, item, container) {\n    var itemData = item.itemData;\n\n    for (var i = 0; i < item.settings.length; i++) {\n      var setting = item.settings[i];\n      this._currentAppointmentSettings = setting;\n      var $item = this.callBase(index, itemData, container);\n      $item.data(APPOINTMENT_SETTINGS_NAME, setting);\n    }\n  },\n  _getItemContent: function ($itemFrame) {\n    $itemFrame.data(APPOINTMENT_SETTINGS_NAME, this._currentAppointmentSettings);\n    var $itemContent = this.callBase($itemFrame);\n    return $itemContent;\n  },\n  _createItemByTemplate: function (itemTemplate, renderArgs) {\n    var itemData = renderArgs.itemData,\n        container = renderArgs.container,\n        index = renderArgs.index;\n    return itemTemplate.render({\n      model: {\n        appointmentData: itemData,\n        targetedAppointmentData: this.invoke(\"getTargetedAppointmentData\", itemData, (0, _renderer2.default)(container).parent())\n      },\n      container: container,\n      index: index\n    });\n  },\n  _getAppointmentContainer: function (allDay) {\n    var $allDayContainer = this.option(\"allDayContainer\");\n    var $container = this.itemsContainer().not($allDayContainer);\n\n    if (allDay && $allDayContainer) {\n      $container = $allDayContainer;\n    }\n\n    return $container;\n  },\n  _postprocessRenderItem: function (args) {\n    this._renderAppointment(args.itemElement, this._currentAppointmentSettings);\n  },\n  _renderAppointment: function ($appointment, settings) {\n    $appointment.data(APPOINTMENT_SETTINGS_NAME, settings);\n\n    this._applyResourceDataAttr($appointment);\n\n    var data = this._getItemData($appointment);\n\n    var geometry = this.invoke(\"getAppointmentGeometry\", settings);\n\n    var allowResize = this.option(\"allowResize\") && (!_type2.default.isDefined(settings.skipResizing) || _type2.default.isString(settings.skipResizing));\n\n    var allowDrag = this.option(\"allowDrag\");\n    var allDay = settings.allDay;\n    this.invoke(\"setCellDataCacheAlias\", this._currentAppointmentSettings, geometry);\n\n    var deferredColor = this._getAppointmentColor($appointment, settings.groupIndex);\n\n    if (settings.virtual) {\n      this._processVirtualAppointment(settings, $appointment, data, deferredColor);\n    } else {\n      this._createComponent($appointment, _uiScheduler4.default, {\n        observer: this.option(\"observer\"),\n        data: data,\n        geometry: geometry,\n        direction: settings.direction || \"vertical\",\n        allowResize: allowResize,\n        allowDrag: allowDrag,\n        allDay: allDay,\n        reduced: settings.appointmentReduced,\n        isCompact: settings.isCompact,\n        startDate: new Date(settings.startDate),\n        cellWidth: this.invoke(\"getCellWidth\"),\n        cellHeight: this.invoke(\"getCellHeight\"),\n        resizableConfig: this._resizableConfig(data, settings)\n      });\n\n      deferredColor.done(function (color) {\n        if (color) {\n          $appointment.css(\"backgroundColor\", color);\n        }\n      });\n    }\n  },\n  _applyResourceDataAttr: function ($appointment) {\n    var resources = this.invoke(\"getResourcesFromItem\", this._getItemData($appointment));\n\n    if (resources) {\n      (0, _iterator.each)(resources, function (name, values) {\n        var attr = \"data-\" + _common2.default.normalizeKey(name.toLowerCase()) + \"-\";\n\n        for (var i = 0; i < values.length; i++) {\n          $appointment.attr(attr + _common2.default.normalizeKey(values[i]), true);\n        }\n      });\n    }\n  },\n  _resizableConfig: function (appointmentData, itemSetting) {\n    return {\n      area: this._calculateResizableArea(itemSetting, appointmentData),\n      onResizeStart: function (e) {\n        this._$currentAppointment = (0, _renderer2.default)(e.element);\n\n        if (this.invoke(\"needRecalculateResizableArea\")) {\n          var updatedArea = this._calculateResizableArea(this._$currentAppointment.data(APPOINTMENT_SETTINGS_NAME), this._$currentAppointment.data(\"dxItemData\"));\n\n          e.component.option(\"area\", updatedArea);\n\n          e.component._renderDragOffsets(e.event);\n        }\n\n        this._initialSize = {\n          width: e.width,\n          height: e.height\n        };\n        this._initialCoordinates = _translator2.default.locate(this._$currentAppointment);\n      }.bind(this),\n      onResizeEnd: function (e) {\n        if (this._escPressed) {\n          e.event.cancel = true;\n          return;\n        }\n\n        this._resizeEndHandler(e);\n      }.bind(this)\n    };\n  },\n  _calculateResizableArea: function (itemSetting, appointmentData) {\n    var area = this.$element().closest(\".dx-scrollable-content\");\n    return this.invoke(\"getResizableAppointmentArea\", {\n      coordinates: {\n        left: itemSetting.left,\n        top: 0,\n        groupIndex: itemSetting.groupIndex\n      },\n      allDay: itemSetting.allDay\n    }) || area;\n  },\n  _resizeEndHandler: function (e) {\n    var $element = (0, _renderer2.default)(e.element);\n\n    var itemData = this._getItemData($element);\n\n    var startDate = this.invoke(\"getStartDate\", itemData, true);\n    var endDate = this.invoke(\"getEndDate\", itemData, true);\n\n    var dateRange = this._getDateRange(e, startDate, endDate);\n\n    var updatedDates = {};\n    this.invoke(\"setField\", \"startDate\", updatedDates, new Date(dateRange[0]));\n    this.invoke(\"setField\", \"endDate\", updatedDates, new Date(dateRange[1]));\n    var data = (0, _extend.extend)({}, itemData, updatedDates);\n    this.notifyObserver(\"updateAppointmentAfterResize\", {\n      target: itemData,\n      data: data,\n      $appointment: $element\n    });\n  },\n  _getDateRange: function (e, startDate, endDate) {\n    var itemData = this._getItemData(e.element);\n\n    var deltaTime = this.invoke(\"getDeltaTime\", e, this._initialSize, itemData);\n    var renderingStrategyDirection = this.invoke(\"getRenderingStrategyDirection\");\n    var isStartDateChanged = false;\n    var isAllDay = this.invoke(\"isAllDay\", itemData);\n    var needCorrectDates = this.invoke(\"needCorrectAppointmentDates\") && !isAllDay;\n    var startTime;\n    var endTime;\n\n    if (\"vertical\" !== renderingStrategyDirection || isAllDay) {\n      isStartDateChanged = this.option(\"rtlEnabled\") ? e.handles.right : e.handles.left;\n    } else {\n      isStartDateChanged = e.handles.top;\n    }\n\n    if (isStartDateChanged) {\n      startTime = needCorrectDates ? this._correctStartDateByDelta(startDate, deltaTime) : startDate.getTime() - deltaTime;\n      startTime += _utilsTimeZone2.default.getTimezoneOffsetChangeInMs(startDate, endDate, startTime, endDate);\n      endTime = endDate.getTime();\n    } else {\n      startTime = startDate.getTime();\n      endTime = needCorrectDates ? this._correctEndDateByDelta(endDate, deltaTime) : endDate.getTime() + deltaTime;\n      endTime -= _utilsTimeZone2.default.getTimezoneOffsetChangeInMs(startDate, endDate, startDate, endTime);\n    }\n\n    return [startTime, endTime];\n  },\n  _correctEndDateByDelta: function (endDate, deltaTime) {\n    var endDayHour = this.invoke(\"getEndDayHour\");\n    var startDayHour = this.invoke(\"getStartDayHour\");\n    var result = endDate.getTime() + deltaTime;\n    var visibleDayDuration = (endDayHour - startDayHour) * toMs(\"hour\");\n    var daysCount = deltaTime > 0 ? Math.ceil(deltaTime / visibleDayDuration) : Math.floor(deltaTime / visibleDayDuration);\n    var maxDate = new Date(endDate);\n    var minDate = new Date(endDate);\n    minDate.setHours(startDayHour, 0, 0, 0);\n    maxDate.setHours(endDayHour, 0, 0, 0);\n\n    if (result > maxDate.getTime() || result <= minDate.getTime()) {\n      var tailOfCurrentDay = maxDate.getTime() - endDate.getTime();\n      var tailOfPrevDays = deltaTime - tailOfCurrentDay;\n      var lastDay = new Date(endDate.setDate(endDate.getDate() + daysCount));\n      lastDay.setHours(startDayHour, 0, 0, 0);\n      result = lastDay.getTime() + tailOfPrevDays - visibleDayDuration * (daysCount - 1);\n    }\n\n    return result;\n  },\n  _correctStartDateByDelta: function (startDate, deltaTime) {\n    var endDayHour = this.invoke(\"getEndDayHour\");\n    var startDayHour = this.invoke(\"getStartDayHour\");\n    var result = startDate.getTime() - deltaTime;\n    var visibleDayDuration = (endDayHour - startDayHour) * toMs(\"hour\");\n    var daysCount = deltaTime > 0 ? Math.ceil(deltaTime / visibleDayDuration) : Math.floor(deltaTime / visibleDayDuration);\n    var maxDate = new Date(startDate);\n    var minDate = new Date(startDate);\n    minDate.setHours(startDayHour, 0, 0, 0);\n    maxDate.setHours(endDayHour, 0, 0, 0);\n\n    if (result < minDate.getTime() || result >= maxDate.getTime()) {\n      var tailOfCurrentDay = startDate.getTime() - minDate.getTime();\n      var tailOfPrevDays = deltaTime - tailOfCurrentDay;\n      var firstDay = new Date(startDate.setDate(startDate.getDate() - daysCount));\n      firstDay.setHours(endDayHour, 0, 0, 0);\n      result = firstDay.getTime() - tailOfPrevDays + visibleDayDuration * (daysCount - 1);\n    }\n\n    return result;\n  },\n  _tryGetAppointmentColor: function (appointment) {\n    var settings = (0, _renderer2.default)(appointment).data(APPOINTMENT_SETTINGS_NAME);\n\n    if (!settings) {\n      return;\n    }\n\n    return this._getAppointmentColor(appointment, settings.groupIndex);\n  },\n  _getAppointmentColor: function ($appointment, groupIndex) {\n    var res = new _deferred.Deferred();\n    var response = this.invoke(\"getAppointmentColor\", {\n      itemData: this._getItemData($appointment),\n      groupIndex: groupIndex\n    });\n    response.done(function (color) {\n      return res.resolve(color);\n    });\n    return res.promise();\n  },\n  _calculateBoundOffset: function () {\n    return this.invoke(\"getBoundOffset\");\n  },\n  _virtualAppointments: {},\n  _processVirtualAppointment: function (appointmentSetting, $appointment, appointmentData, color) {\n    var virtualAppointment = appointmentSetting.virtual;\n    var virtualGroupIndex = virtualAppointment.index;\n\n    if (!_type2.default.isDefined(this._virtualAppointments[virtualGroupIndex])) {\n      this._virtualAppointments[virtualGroupIndex] = {\n        coordinates: {\n          top: virtualAppointment.top,\n          left: virtualAppointment.left\n        },\n        items: {\n          data: [],\n          colors: [],\n          settings: []\n        },\n        isAllDay: virtualAppointment.isAllDay ? true : false,\n        buttonColor: color\n      };\n    }\n\n    appointmentSetting.targetedAppointmentData = this.invoke(\"getTargetedAppointmentData\", appointmentData, $appointment);\n\n    this._virtualAppointments[virtualGroupIndex].items.settings.push(appointmentSetting);\n\n    this._virtualAppointments[virtualGroupIndex].items.data.push(appointmentData);\n\n    this._virtualAppointments[virtualGroupIndex].items.colors.push(color);\n\n    $appointment.remove();\n  },\n  _renderContentImpl: function () {\n    this.callBase();\n\n    this._renderDropDownAppointments();\n  },\n  _renderDropDownAppointments: function () {\n    (0, _iterator.each)(this._virtualAppointments, function (groupIndex) {\n      var virtualGroup = this._virtualAppointments[groupIndex];\n      var virtualItems = virtualGroup.items;\n      var virtualCoordinates = virtualGroup.coordinates;\n      var $container = virtualGroup.isAllDay ? this.option(\"allDayContainer\") : this.$element();\n      var left = virtualCoordinates.left;\n      var buttonWidth = this.invoke(\"getDropDownAppointmentWidth\", virtualGroup.isAllDay);\n      var buttonHeight = this.invoke(\"getDropDownAppointmentHeight\");\n      var rtlOffset = this.option(\"rtlEnabled\") ? buttonWidth : 0;\n      this.notifyObserver(\"renderCompactAppointments\", {\n        $container: $container,\n        coordinates: {\n          top: virtualCoordinates.top,\n          left: left + rtlOffset\n        },\n        items: virtualItems,\n        buttonColor: virtualGroup.buttonColor,\n        width: buttonWidth - this.option(\"_collectorOffset\"),\n        height: buttonHeight,\n        onAppointmentClick: this.option(\"onItemClick\"),\n        allowDrag: this.option(\"allowDrag\"),\n        cellWidth: this.invoke(\"getCellWidth\"),\n        isCompact: this.invoke(\"isAdaptive\") || this._isGroupCompact(virtualGroup),\n        applyOffset: !virtualGroup.isAllDay && this.invoke(\"isApplyCompactAppointmentOffset\")\n      });\n    }.bind(this));\n  },\n  _isGroupCompact: function (virtualGroup) {\n    return !virtualGroup.isAllDay && this.invoke(\"supportCompactDropDownAppointments\");\n  },\n  _sortAppointmentsByStartDate: function (appointments) {\n    appointments.sort(function (a, b) {\n      var result = 0;\n      var firstDate = new Date(this.invoke(\"getField\", \"startDate\", a.settings || a)).getTime();\n      var secondDate = new Date(this.invoke(\"getField\", \"startDate\", b.settings || b)).getTime();\n\n      if (firstDate < secondDate) {\n        result = -1;\n      }\n\n      if (firstDate > secondDate) {\n        result = 1;\n      }\n\n      return result;\n    }.bind(this));\n  },\n  _processRecurrenceAppointment: function (appointment, index, skipLongAppointments) {\n    var recurrenceRule = this.invoke(\"getField\", \"recurrenceRule\", appointment);\n    var result = {\n      parts: [],\n      indexes: []\n    };\n\n    if (recurrenceRule) {\n      var dates = appointment.settings || appointment;\n      var startDate = new Date(this.invoke(\"getField\", \"startDate\", dates));\n      var endDate = new Date(this.invoke(\"getField\", \"endDate\", dates));\n      var appointmentDuration = endDate.getTime() - startDate.getTime();\n      var recurrenceException = this.invoke(\"getField\", \"recurrenceException\", appointment);\n      var startViewDate = this.invoke(\"getStartViewDate\");\n      var endViewDate = this.invoke(\"getEndViewDate\");\n\n      var recurrentDates = _utils2.default.getDatesByRecurrence({\n        rule: recurrenceRule,\n        exception: recurrenceException,\n        start: startDate,\n        end: endDate,\n        min: startViewDate,\n        max: endViewDate\n      });\n\n      var recurrentDateCount = appointment.settings ? 1 : recurrentDates.length;\n\n      for (var i = 0; i < recurrentDateCount; i++) {\n        var appointmentPart = (0, _extend.extend)({}, appointment, true);\n\n        if (recurrentDates[i]) {\n          var appointmentSettings = this._applyStartDateToObj(recurrentDates[i], {});\n\n          this._applyEndDateToObj(new Date(recurrentDates[i].getTime() + appointmentDuration), appointmentSettings);\n\n          appointmentPart.settings = appointmentSettings;\n        } else {\n          appointmentPart.settings = dates;\n        }\n\n        result.parts.push(appointmentPart);\n\n        if (!skipLongAppointments) {\n          this._processLongAppointment(appointmentPart, result);\n        }\n      }\n\n      result.indexes.push(index);\n    }\n\n    return result;\n  },\n  _processLongAppointment: function (appointment, result) {\n    var parts = this.splitAppointmentByDay(appointment);\n    var partCount = parts.length;\n    var endViewDate = this.invoke(\"getEndViewDate\").getTime();\n    var startViewDate = this.invoke(\"getStartViewDate\").getTime();\n    var startDateTimeZone = this.invoke(\"getField\", \"startDateTimeZone\", appointment);\n    result = result || {\n      parts: []\n    };\n\n    if (partCount > 1) {\n      (0, _extend.extend)(appointment, parts[0]);\n\n      for (var i = 1; i < partCount; i++) {\n        var startDate = this.invoke(\"getField\", \"startDate\", parts[i].settings).getTime();\n        startDate = this.invoke(\"convertDateByTimezone\", startDate, startDateTimeZone);\n\n        if (startDate < endViewDate && startDate > startViewDate) {\n          result.parts.push(parts[i]);\n        }\n      }\n    }\n\n    return result;\n  },\n  _reduceRecurrenceAppointments: function (recurrenceIndexes, appointments) {\n    (0, _iterator.each)(recurrenceIndexes, function (i, index) {\n      appointments.splice(index - i, 1);\n    });\n  },\n  _combineAppointments: function (appointments, additionalAppointments) {\n    if (additionalAppointments.length) {\n      _array2.default.merge(appointments, additionalAppointments);\n    }\n\n    this._sortAppointmentsByStartDate(appointments);\n  },\n  _applyStartDateToObj: function (startDate, obj) {\n    this.invoke(\"setField\", \"startDate\", obj, startDate);\n    return obj;\n  },\n  _applyEndDateToObj: function (endDate, obj) {\n    this.invoke(\"setField\", \"endDate\", obj, endDate);\n    return obj;\n  },\n  moveAppointmentBack: function (dragEvent) {\n    var $appointment = this._$currentAppointment;\n    var size = this._initialSize;\n    var coords = this._initialCoordinates;\n\n    if (dragEvent) {\n      if (_type2.default.isDeferred(dragEvent.cancel)) {\n        dragEvent.cancel.resolve(true);\n      } else {\n        dragEvent.cancel = true;\n      }\n    }\n\n    this.notifyObserver(\"moveBack\");\n\n    if ($appointment && !dragEvent) {\n      if (coords) {\n        _translator2.default.move($appointment, coords);\n\n        delete this._initialSize;\n      }\n\n      if (size) {\n        $appointment.outerWidth(size.width);\n        $appointment.outerHeight(size.height);\n        delete this._initialCoordinates;\n      }\n    }\n  },\n  focus: function () {\n    if (this._$currentAppointment) {\n      var focusedElement = (0, _dom.getPublicElement)(this._$currentAppointment);\n      this.option(\"focusedElement\", focusedElement);\n\n      _events_engine2.default.trigger(focusedElement, \"focus\");\n    }\n  },\n  splitAppointmentByDay: function (appointment) {\n    var dates = appointment.settings || appointment;\n    var originalStartDate = new Date(this.invoke(\"getField\", \"startDate\", dates));\n\n    var startDate = _date2.default.makeDate(originalStartDate);\n\n    var endDate = _date2.default.makeDate(this.invoke(\"getField\", \"endDate\", dates));\n\n    var startDateTimeZone = this.invoke(\"getField\", \"startDateTimeZone\", appointment);\n    var endDateTimeZone = this.invoke(\"getField\", \"endDateTimeZone\", appointment);\n    var maxAllowedDate = this.invoke(\"getEndViewDate\");\n    var startDayHour = this.invoke(\"getStartDayHour\");\n    var endDayHour = this.invoke(\"getEndDayHour\");\n    var appointmentIsLong = this.invoke(\"appointmentTakesSeveralDays\", appointment);\n    var result = [];\n    startDate = this.invoke(\"convertDateByTimezone\", startDate, startDateTimeZone);\n    endDate = this.invoke(\"convertDateByTimezone\", endDate, endDateTimeZone);\n\n    if (startDate.getHours() <= endDayHour && startDate.getHours() >= startDayHour && !appointmentIsLong) {\n      result.push(this._applyStartDateToObj(new Date(startDate), {\n        appointmentData: appointment\n      }));\n      startDate.setDate(startDate.getDate() + 1);\n    }\n\n    while (appointmentIsLong && startDate.getTime() < endDate.getTime() - 1 && startDate < maxAllowedDate) {\n      var currentStartDate = new Date(startDate);\n      var currentEndDate = new Date(startDate);\n\n      this._checkStartDate(currentStartDate, originalStartDate, startDayHour);\n\n      this._checkEndDate(currentEndDate, endDate, endDayHour);\n\n      var appointmentData = _object2.default.deepExtendArraySafe({}, appointment, true);\n\n      var appointmentSettings = {};\n\n      this._applyStartDateToObj(currentStartDate, appointmentSettings);\n\n      this._applyEndDateToObj(currentEndDate, appointmentSettings);\n\n      appointmentData.settings = appointmentSettings;\n      result.push(appointmentData);\n      startDate.setDate(startDate.getDate() + 1);\n      startDate.setHours(startDayHour);\n    }\n\n    return result;\n  },\n  _checkStartDate: function (currentDate, originalDate, startDayHour) {\n    if (!_date2.default.sameDate(currentDate, originalDate) || currentDate.getHours() <= startDayHour) {\n      currentDate.setHours(startDayHour, 0, 0, 0);\n    } else {\n      currentDate.setHours(originalDate.getHours(), originalDate.getMinutes(), originalDate.getSeconds(), originalDate.getMilliseconds());\n    }\n  },\n  _checkEndDate: function (currentDate, originalDate, endDayHour) {\n    if (!_date2.default.sameDate(currentDate, originalDate) || currentDate.getHours() > endDayHour) {\n      currentDate.setHours(endDayHour, 0, 0, 0);\n    } else {\n      currentDate.setHours(originalDate.getHours(), originalDate.getMinutes(), originalDate.getSeconds(), originalDate.getMilliseconds());\n    }\n  }\n}).include(_uiScheduler2.default);\n\n(0, _component_registrator2.default)(\"dxSchedulerAppointments\", SchedulerAppointments);\nmodule.exports = SchedulerAppointments;","map":{"version":3,"sources":["/Users/tracyvy/Desktop/UCB_Coding_Bootcamp/project_3/calendar/client/node_modules/devextreme/ui/scheduler/ui.scheduler.appointments.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_renderer","require","_renderer2","_interopRequireDefault","_dom_adapter","_dom_adapter2","_events_engine","_events_engine2","_element_data","_element_data2","_translator","_translator2","_date","_date2","_common","_common2","_type","_type2","_iterator","_object","_object2","_array","_array2","_extend","_dom","_utils","_utils2","_component_registrator","_component_registrator2","_uiScheduler","_uiScheduler2","_uiScheduler3","_uiScheduler4","_utils3","eventUtils","_interopRequireWildcard","_double_click","_double_click2","_message","_message2","_uiCollection_widget","_uiCollection_widget2","_deferred","_utilsTimeZone","_utilsTimeZone2","_getRequireWildcardCache","WeakMap","cache","__esModule","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","default","APPOINTMENT_SETTINGS_NAME","COMPONENT_CLASS","APPOINTMENT_ITEM_CLASS","APPOINTMENT_TITLE_CLASS","APPOINTMENT_CONTENT_DETAILS_CLASS","APPOINTMENT_DATE_CLASS","RECURRING_ICON_CLASS","ALL_DAY_CONTENT_CLASS","DBLCLICK_EVENT_NAME","addNamespace","name","toMs","dateToMilliseconds","SchedulerAppointments","inherit","ctor","element","options","callBase","_supportedKeys","parent","tabHandler","e","appointments","_getAccessAppointments","focusedAppointment","filter","index","data","sortedIndex","lastIndex","length","shiftKey","preventDefault","$nextAppointment","_getAppointmentByIndex","_resetTabIndex","trigger","extend","escape","moveAppointmentBack","_escPressed","bind","del","option","_getItemData","target","notifyObserver","tab","_","$item","eq","_itemElements","not","$appointment","_focusTarget","attr","_moveFocus","noop","_renderFocusTarget","_focusInHandler","apply","arguments","_$currentAppointment","getPublicElement","_focusOutHandler","_eventBindingTarget","_itemContainer","_getDefaultOptions","noDataText","activeStateEnabled","hoverStateEnabled","tabIndex","fixedContainer","allDayContainer","allowDrag","allowResize","allowAllDayResize","onAppointmentDblClick","_collectorOffset","_optionChanged","args","_cleanFocusState","_clearDropDownItems","_clearDropDownItemsElements","_repaintAppointments","value","_renderDropDownAppointments","_attachAppointmentsEvents","_invalidate","_isAllDayAppointment","appointment","settings","allDay","_isRepaintAppointment","isDefined","needRepaint","_isRepaintAll","invoke","i","_applyFragment","fragment","children","_getAppointmentContainer","append","_onEachAppointment","container","isRepaintAll","needRemove","_clearItem","_renderItem","_this","allDayFragment","commonFragment","html","_cleanItemContainer","forEach","_attachClickEvent","_attachHoldEvent","_attachContextMenuEvent","_attachAppointmentDblClick","_renderFocusState","_attachFeedbackEvents","_attachHoverEvents","item","$items","_findItemElementByItem","itemData","each","detach","remove","_virtualAppointments","result","that","itemElements","_itemDataKey","push","_itemClass","$container","$result","$allDayContainer","add","empty","_clean","_initialSize","_initialCoordinates","_init","$element","addClass","_preventSingleAppointmentClick","_renderAppointmentTemplate","model","formatText","appointmentData","targetedAppointmentData","text","appendTo","isPlainObject","$contentDetails","formatDate","recurrenceRule","format","prependTo","_executeItemRenderAction","itemElement","action","_getItemRenderAction","_currentAppointmentSettings","_itemClickHandler","afterExecute","_processItemClick","event","$target","currentTarget","type","isFakeClickEvent","_appointmentClickTimeout","setTimeout","getBody","contains","_extendActionArgs","_render","itemSelector","_itemSelector","itemContainer","off","on","_itemDXEventHandler","_dblClickHandler","$targetAppointment","clearTimeout","setting","_getItemContent","$itemFrame","$itemContent","_createItemByTemplate","itemTemplate","renderArgs","render","itemsContainer","_postprocessRenderItem","_renderAppointment","_applyResourceDataAttr","geometry","skipResizing","isString","deferredColor","_getAppointmentColor","groupIndex","virtual","_processVirtualAppointment","_createComponent","observer","direction","reduced","appointmentReduced","isCompact","startDate","Date","cellWidth","cellHeight","resizableConfig","_resizableConfig","done","color","css","resources","values","normalizeKey","toLowerCase","itemSetting","area","_calculateResizableArea","onResizeStart","updatedArea","component","_renderDragOffsets","width","height","locate","onResizeEnd","cancel","_resizeEndHandler","closest","coordinates","left","top","endDate","dateRange","_getDateRange","updatedDates","deltaTime","renderingStrategyDirection","isStartDateChanged","isAllDay","needCorrectDates","startTime","endTime","handles","right","_correctStartDateByDelta","getTime","getTimezoneOffsetChangeInMs","_correctEndDateByDelta","endDayHour","startDayHour","visibleDayDuration","daysCount","Math","ceil","floor","maxDate","minDate","setHours","tailOfCurrentDay","tailOfPrevDays","lastDay","setDate","getDate","firstDay","_tryGetAppointmentColor","res","Deferred","response","resolve","promise","_calculateBoundOffset","appointmentSetting","virtualAppointment","virtualGroupIndex","items","colors","buttonColor","_renderContentImpl","virtualGroup","virtualItems","virtualCoordinates","buttonWidth","buttonHeight","rtlOffset","onAppointmentClick","_isGroupCompact","applyOffset","_sortAppointmentsByStartDate","sort","a","b","firstDate","secondDate","_processRecurrenceAppointment","skipLongAppointments","parts","indexes","dates","appointmentDuration","recurrenceException","startViewDate","endViewDate","recurrentDates","getDatesByRecurrence","rule","exception","start","end","min","max","recurrentDateCount","appointmentPart","appointmentSettings","_applyStartDateToObj","_applyEndDateToObj","_processLongAppointment","splitAppointmentByDay","partCount","startDateTimeZone","_reduceRecurrenceAppointments","recurrenceIndexes","splice","_combineAppointments","additionalAppointments","merge","dragEvent","size","coords","isDeferred","move","outerWidth","outerHeight","focus","focusedElement","originalStartDate","makeDate","endDateTimeZone","maxAllowedDate","appointmentIsLong","getHours","currentStartDate","currentEndDate","_checkStartDate","_checkEndDate","deepExtendArraySafe","currentDate","originalDate","sameDate","getMinutes","getSeconds","getMilliseconds","include","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointments.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\n\r\nfunction _typeof(obj) {\r\n    \"@babel/helpers - typeof\";\r\n    if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\r\n        _typeof = function(obj) {\r\n            return typeof obj\r\n        }\r\n    } else {\r\n        _typeof = function(obj) {\r\n            return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj\r\n        }\r\n    }\r\n    return _typeof(obj)\r\n}\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _dom_adapter = require(\"../../core/dom_adapter\");\r\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _element_data = require(\"../../core/element_data\");\r\nvar _element_data2 = _interopRequireDefault(_element_data);\r\nvar _translator = require(\"../../animation/translator\");\r\nvar _translator2 = _interopRequireDefault(_translator);\r\nvar _date = require(\"../../core/utils/date\");\r\nvar _date2 = _interopRequireDefault(_date);\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _common2 = _interopRequireDefault(_common);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _type2 = _interopRequireDefault(_type);\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _object = require(\"../../core/utils/object\");\r\nvar _object2 = _interopRequireDefault(_object);\r\nvar _array = require(\"../../core/utils/array\");\r\nvar _array2 = _interopRequireDefault(_array);\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _dom = require(\"../../core/utils/dom\");\r\nvar _utils = require(\"./utils.recurrence\");\r\nvar _utils2 = _interopRequireDefault(_utils);\r\nvar _component_registrator = require(\"../../core/component_registrator\");\r\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\r\nvar _uiScheduler = require(\"./ui.scheduler.publisher_mixin\");\r\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\r\nvar _uiScheduler3 = require(\"./ui.scheduler.appointment\");\r\nvar _uiScheduler4 = _interopRequireDefault(_uiScheduler3);\r\nvar _utils3 = require(\"../../events/utils\");\r\nvar eventUtils = _interopRequireWildcard(_utils3);\r\nvar _double_click = require(\"../../events/double_click\");\r\nvar _double_click2 = _interopRequireDefault(_double_click);\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _uiCollection_widget = require(\"../collection/ui.collection_widget.edit\");\r\nvar _uiCollection_widget2 = _interopRequireDefault(_uiCollection_widget);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _utilsTimeZone = require(\"./utils.timeZone.js\");\r\nvar _utilsTimeZone2 = _interopRequireDefault(_utilsTimeZone);\r\n\r\nfunction _getRequireWildcardCache() {\r\n    if (\"function\" !== typeof WeakMap) {\r\n        return null\r\n    }\r\n    var cache = new WeakMap;\r\n    _getRequireWildcardCache = function() {\r\n        return cache\r\n    };\r\n    return cache\r\n}\r\n\r\nfunction _interopRequireWildcard(obj) {\r\n    if (obj && obj.__esModule) {\r\n        return obj\r\n    }\r\n    if (null === obj || \"object\" !== _typeof(obj) && \"function\" !== typeof obj) {\r\n        return {\r\n            \"default\": obj\r\n        }\r\n    }\r\n    var cache = _getRequireWildcardCache();\r\n    if (cache && cache.has(obj)) {\r\n        return cache.get(obj)\r\n    }\r\n    var newObj = {};\r\n    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\r\n    for (var key in obj) {\r\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\r\n            if (desc && (desc.get || desc.set)) {\r\n                Object.defineProperty(newObj, key, desc)\r\n            } else {\r\n                newObj[key] = obj[key]\r\n            }\r\n        }\r\n    }\r\n    newObj.default = obj;\r\n    if (cache) {\r\n        cache.set(obj, newObj)\r\n    }\r\n    return newObj\r\n}\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar APPOINTMENT_SETTINGS_NAME = \"dxAppointmentSettings\";\r\nvar COMPONENT_CLASS = \"dx-scheduler-scrollable-appointments\";\r\nvar APPOINTMENT_ITEM_CLASS = \"dx-scheduler-appointment\";\r\nvar APPOINTMENT_TITLE_CLASS = \"dx-scheduler-appointment-title\";\r\nvar APPOINTMENT_CONTENT_DETAILS_CLASS = \"dx-scheduler-appointment-content-details\";\r\nvar APPOINTMENT_DATE_CLASS = \"dx-scheduler-appointment-content-date\";\r\nvar RECURRING_ICON_CLASS = \"dx-scheduler-appointment-recurrence-icon\";\r\nvar ALL_DAY_CONTENT_CLASS = \"dx-scheduler-appointment-content-allday\";\r\nvar DBLCLICK_EVENT_NAME = eventUtils.addNamespace(_double_click2.default.name, \"dxSchedulerAppointment\");\r\nvar toMs = _date2.default.dateToMilliseconds;\r\nvar SchedulerAppointments = _uiCollection_widget2.default.inherit({\r\n    ctor: function(element, options) {\r\n        this.callBase(element, options)\r\n    },\r\n    _supportedKeys: function() {\r\n        var parent = this.callBase();\r\n        var tabHandler = function(e) {\r\n            var appointments = this._getAccessAppointments();\r\n            var focusedAppointment = appointments.filter(\".dx-state-focused\");\r\n            var index = focusedAppointment.data(APPOINTMENT_SETTINGS_NAME).sortedIndex;\r\n            var lastIndex = appointments.length - 1;\r\n            if (index > 0 && e.shiftKey || index < lastIndex && !e.shiftKey) {\r\n                e.preventDefault();\r\n                e.shiftKey ? index-- : index++;\r\n                var $nextAppointment = this._getAppointmentByIndex(index);\r\n                this._resetTabIndex($nextAppointment);\r\n                _events_engine2.default.trigger($nextAppointment, \"focus\")\r\n            }\r\n        };\r\n        return (0, _extend.extend)(parent, {\r\n            escape: function() {\r\n                this.moveAppointmentBack();\r\n                this._escPressed = true\r\n            }.bind(this),\r\n            del: function(e) {\r\n                if (this.option(\"allowDelete\")) {\r\n                    e.preventDefault();\r\n                    var data = this._getItemData(e.target);\r\n                    this.notifyObserver(\"deleteAppointment\", {\r\n                        data: data,\r\n                        target: e.target\r\n                    });\r\n                    this.notifyObserver(\"hideAppointmentTooltip\")\r\n                }\r\n            }.bind(this),\r\n            tab: tabHandler\r\n        })\r\n    },\r\n    _getAppointmentByIndex: function(sortedIndex) {\r\n        var appointments = this._getAccessAppointments();\r\n        return appointments.filter(function(_, $item) {\r\n            return _element_data2.default.data($item, APPOINTMENT_SETTINGS_NAME).sortedIndex === sortedIndex\r\n        }).eq(0)\r\n    },\r\n    _getAccessAppointments: function() {\r\n        return this._itemElements().filter(\":visible\").not(\".dx-state-disabled\")\r\n    },\r\n    _resetTabIndex: function($appointment) {\r\n        this._focusTarget().attr(\"tabIndex\", -1);\r\n        $appointment.attr(\"tabIndex\", this.option(\"tabIndex\"))\r\n    },\r\n    _moveFocus: _common2.default.noop,\r\n    _focusTarget: function() {\r\n        return this._itemElements()\r\n    },\r\n    _renderFocusTarget: function() {\r\n        var $appointment = this._getAppointmentByIndex(0);\r\n        this._resetTabIndex($appointment)\r\n    },\r\n    _focusInHandler: function(e) {\r\n        this.callBase.apply(this, arguments);\r\n        this._$currentAppointment = (0, _renderer2.default)(e.target);\r\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)((0, _renderer2.default)(e.target)))\r\n    },\r\n    _focusOutHandler: function() {\r\n        var $appointment = this._getAppointmentByIndex(0);\r\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($appointment));\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _eventBindingTarget: function() {\r\n        return this._itemContainer()\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            noDataText: null,\r\n            activeStateEnabled: true,\r\n            hoverStateEnabled: true,\r\n            tabIndex: 0,\r\n            fixedContainer: null,\r\n            allDayContainer: null,\r\n            allowDrag: true,\r\n            allowResize: true,\r\n            allowAllDayResize: true,\r\n            onAppointmentDblClick: null,\r\n            _collectorOffset: 0\r\n        })\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"items\":\r\n                this._cleanFocusState();\r\n                this._clearDropDownItems();\r\n                this._clearDropDownItemsElements();\r\n                this._repaintAppointments(args.value);\r\n                this._renderDropDownAppointments();\r\n                this._attachAppointmentsEvents();\r\n                break;\r\n            case \"fixedContainer\":\r\n            case \"allDayContainer\":\r\n            case \"onAppointmentDblClick\":\r\n                break;\r\n            case \"allowDrag\":\r\n            case \"allowResize\":\r\n            case \"allowAllDayResize\":\r\n                this._invalidate();\r\n                break;\r\n            case \"focusedElement\":\r\n                this._resetTabIndex((0, _renderer2.default)(args.value));\r\n                this.callBase(args);\r\n                break;\r\n            case \"allowDelete\":\r\n                break;\r\n            case \"focusStateEnabled\":\r\n                this._clearDropDownItemsElements();\r\n                this._renderDropDownAppointments();\r\n                this.callBase(args);\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _isAllDayAppointment: function(appointment) {\r\n        return appointment.settings.length && appointment.settings[0].allDay || false\r\n    },\r\n    _isRepaintAppointment: function(appointment) {\r\n        return !_type2.default.isDefined(appointment.needRepaint) || true === appointment.needRepaint\r\n    },\r\n    _isRepaintAll: function(appointments) {\r\n        if (this.invoke(\"isCurrentViewAgenda\")) {\r\n            return true\r\n        }\r\n        for (var i = 0; i < appointments.length; i++) {\r\n            var appointment = appointments[i];\r\n            if (!this._isRepaintAppointment(appointment)) {\r\n                return false\r\n            }\r\n        }\r\n        return true\r\n    },\r\n    _applyFragment: function(fragment, allDay) {\r\n        if (fragment.children().length > 0) {\r\n            this._getAppointmentContainer(allDay).append(fragment)\r\n        }\r\n    },\r\n    _onEachAppointment: function(appointment, index, container, isRepaintAll) {\r\n        if (appointment && true === appointment.needRemove) {\r\n            this._clearItem(appointment);\r\n            return\r\n        }\r\n        if (this._isRepaintAppointment(appointment)) {\r\n            appointment.needRepaint = false;\r\n            !isRepaintAll && this._clearItem(appointment);\r\n            this._renderItem(index, appointment, container)\r\n        }\r\n    },\r\n    _repaintAppointments: function(appointments) {\r\n        var _this = this;\r\n        var isRepaintAll = this._isRepaintAll(appointments);\r\n        var allDayFragment = (0, _renderer2.default)(this._getAppointmentContainer(true));\r\n        var commonFragment = (0, _renderer2.default)(this._getAppointmentContainer(false));\r\n        if (isRepaintAll) {\r\n            this._getAppointmentContainer(true).html(\"\");\r\n            this._getAppointmentContainer(false).html(\"\")\r\n        }!appointments.length && this._cleanItemContainer();\r\n        appointments.forEach(function(appointment, index) {\r\n            var container = _this._isAllDayAppointment(appointment) ? allDayFragment : commonFragment;\r\n            _this._onEachAppointment(appointment, index, container, isRepaintAll)\r\n        });\r\n        this._applyFragment(allDayFragment, true);\r\n        this._applyFragment(commonFragment, false)\r\n    },\r\n    _attachAppointmentsEvents: function() {\r\n        this._attachClickEvent();\r\n        this._attachHoldEvent();\r\n        this._attachContextMenuEvent();\r\n        this._attachAppointmentDblClick();\r\n        this._renderFocusState();\r\n        this._attachFeedbackEvents();\r\n        this._attachHoverEvents()\r\n    },\r\n    _clearItem: function(item) {\r\n        var $items = this._findItemElementByItem(item.itemData);\r\n        if (!$items.length) {\r\n            return\r\n        }(0, _iterator.each)($items, function(_, $item) {\r\n            $item.detach();\r\n            $item.remove()\r\n        })\r\n    },\r\n    _clearDropDownItems: function() {\r\n        this._virtualAppointments = {}\r\n    },\r\n    _clearDropDownItemsElements: function() {\r\n        this.invoke(\"clearCompactAppointments\")\r\n    },\r\n    _findItemElementByItem: function(item) {\r\n        var result = [];\r\n        var that = this;\r\n        this.itemElements().each(function() {\r\n            var $item = (0, _renderer2.default)(this);\r\n            if ($item.data(that._itemDataKey()) === item) {\r\n                result.push($item)\r\n            }\r\n        });\r\n        return result\r\n    },\r\n    _itemClass: function() {\r\n        return APPOINTMENT_ITEM_CLASS\r\n    },\r\n    _itemContainer: function() {\r\n        var $container = this.callBase();\r\n        var $result = $container;\r\n        var $allDayContainer = this.option(\"allDayContainer\");\r\n        if ($allDayContainer) {\r\n            $result = $container.add($allDayContainer)\r\n        }\r\n        return $result\r\n    },\r\n    _cleanItemContainer: function() {\r\n        this.callBase();\r\n        var $allDayContainer = this.option(\"allDayContainer\");\r\n        if ($allDayContainer) {\r\n            $allDayContainer.empty()\r\n        }\r\n        this._virtualAppointments = {}\r\n    },\r\n    _clean: function() {\r\n        this.callBase();\r\n        delete this._$currentAppointment;\r\n        delete this._initialSize;\r\n        delete this._initialCoordinates\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this.$element().addClass(COMPONENT_CLASS);\r\n        this._preventSingleAppointmentClick = false\r\n    },\r\n    _renderAppointmentTemplate: function($container, data, model) {\r\n        var formatText = this.invoke(\"getTextAndFormatDate\", model.appointmentData, model.appointmentData.settings || model.targetedAppointmentData || {}, \"TIME\");\r\n        (0, _renderer2.default)(\"<div>\").text(formatText.text).addClass(APPOINTMENT_TITLE_CLASS).appendTo($container);\r\n        if (_type2.default.isPlainObject(data)) {\r\n            if (data.html) {\r\n                $container.html(data.html)\r\n            }\r\n        }\r\n        var $contentDetails = (0, _renderer2.default)(\"<div>\").addClass(APPOINTMENT_CONTENT_DETAILS_CLASS);\r\n        (0, _renderer2.default)(\"<div>\").addClass(APPOINTMENT_DATE_CLASS).text(formatText.formatDate).appendTo($contentDetails);\r\n        $contentDetails.appendTo($container);\r\n        if (data.recurrenceRule) {\r\n            (0, _renderer2.default)(\"<span>\").addClass(RECURRING_ICON_CLASS + \" dx-icon-repeat\").appendTo($container)\r\n        }\r\n        if (data.allDay) {\r\n            (0, _renderer2.default)(\"<div>\").text(\" \" + _message2.default.format(\"dxScheduler-allDay\") + \": \").addClass(ALL_DAY_CONTENT_CLASS).prependTo($contentDetails)\r\n        }\r\n    },\r\n    _executeItemRenderAction: function(index, itemData, itemElement) {\r\n        var action = this._getItemRenderAction();\r\n        if (action) {\r\n            action(this.invoke(\"mapAppointmentFields\", {\r\n                itemData: itemData,\r\n                itemElement: itemElement\r\n            }))\r\n        }\r\n        delete this._currentAppointmentSettings\r\n    },\r\n    _itemClickHandler: function(e) {\r\n        this.callBase(e, {}, {\r\n            afterExecute: function(e) {\r\n                this._processItemClick(e.args[0].event)\r\n            }.bind(this)\r\n        })\r\n    },\r\n    _processItemClick: function(e) {\r\n        var $target = (0, _renderer2.default)(e.currentTarget);\r\n        var data = this._getItemData($target);\r\n        if (\"keydown\" === e.type || eventUtils.isFakeClickEvent(e)) {\r\n            this.notifyObserver(\"showEditAppointmentPopup\", {\r\n                data: data,\r\n                target: $target\r\n            });\r\n            return\r\n        }\r\n        this._appointmentClickTimeout = setTimeout(function() {\r\n            if (!this._preventSingleAppointmentClick && _dom_adapter2.default.getBody().contains($target[0])) {\r\n                this.notifyObserver(\"showAppointmentTooltip\", {\r\n                    data: data,\r\n                    target: $target\r\n                })\r\n            }\r\n            this._preventSingleAppointmentClick = false\r\n        }.bind(this), 300)\r\n    },\r\n    _extendActionArgs: function() {\r\n        var args = this.callBase.apply(this, arguments);\r\n        return this.invoke(\"mapAppointmentFields\", args)\r\n    },\r\n    _render: function() {\r\n        this.callBase.apply(this, arguments);\r\n        this._attachAppointmentDblClick()\r\n    },\r\n    _attachAppointmentDblClick: function() {\r\n        var that = this;\r\n        var itemSelector = that._itemSelector();\r\n        var itemContainer = this._itemContainer();\r\n        _events_engine2.default.off(itemContainer, DBLCLICK_EVENT_NAME, itemSelector);\r\n        _events_engine2.default.on(itemContainer, DBLCLICK_EVENT_NAME, itemSelector, function(e) {\r\n            that._itemDXEventHandler(e, \"onAppointmentDblClick\", {}, {\r\n                afterExecute: function(e) {\r\n                    that._dblClickHandler(e.args[0].event)\r\n                }\r\n            })\r\n        })\r\n    },\r\n    _dblClickHandler: function(e) {\r\n        var $targetAppointment = (0, _renderer2.default)(e.currentTarget);\r\n        var appointmentData = this._getItemData($targetAppointment);\r\n        clearTimeout(this._appointmentClickTimeout);\r\n        this._preventSingleAppointmentClick = true;\r\n        this.notifyObserver(\"showEditAppointmentPopup\", {\r\n            data: appointmentData,\r\n            target: $targetAppointment\r\n        })\r\n    },\r\n    _renderItem: function(index, item, container) {\r\n        var itemData = item.itemData;\r\n        for (var i = 0; i < item.settings.length; i++) {\r\n            var setting = item.settings[i];\r\n            this._currentAppointmentSettings = setting;\r\n            var $item = this.callBase(index, itemData, container);\r\n            $item.data(APPOINTMENT_SETTINGS_NAME, setting)\r\n        }\r\n    },\r\n    _getItemContent: function($itemFrame) {\r\n        $itemFrame.data(APPOINTMENT_SETTINGS_NAME, this._currentAppointmentSettings);\r\n        var $itemContent = this.callBase($itemFrame);\r\n        return $itemContent\r\n    },\r\n    _createItemByTemplate: function(itemTemplate, renderArgs) {\r\n        var itemData = renderArgs.itemData,\r\n            container = renderArgs.container,\r\n            index = renderArgs.index;\r\n        return itemTemplate.render({\r\n            model: {\r\n                appointmentData: itemData,\r\n                targetedAppointmentData: this.invoke(\"getTargetedAppointmentData\", itemData, (0, _renderer2.default)(container).parent())\r\n            },\r\n            container: container,\r\n            index: index\r\n        })\r\n    },\r\n    _getAppointmentContainer: function(allDay) {\r\n        var $allDayContainer = this.option(\"allDayContainer\");\r\n        var $container = this.itemsContainer().not($allDayContainer);\r\n        if (allDay && $allDayContainer) {\r\n            $container = $allDayContainer\r\n        }\r\n        return $container\r\n    },\r\n    _postprocessRenderItem: function(args) {\r\n        this._renderAppointment(args.itemElement, this._currentAppointmentSettings)\r\n    },\r\n    _renderAppointment: function($appointment, settings) {\r\n        $appointment.data(APPOINTMENT_SETTINGS_NAME, settings);\r\n        this._applyResourceDataAttr($appointment);\r\n        var data = this._getItemData($appointment);\r\n        var geometry = this.invoke(\"getAppointmentGeometry\", settings);\r\n        var allowResize = this.option(\"allowResize\") && (!_type2.default.isDefined(settings.skipResizing) || _type2.default.isString(settings.skipResizing));\r\n        var allowDrag = this.option(\"allowDrag\");\r\n        var allDay = settings.allDay;\r\n        this.invoke(\"setCellDataCacheAlias\", this._currentAppointmentSettings, geometry);\r\n        var deferredColor = this._getAppointmentColor($appointment, settings.groupIndex);\r\n        if (settings.virtual) {\r\n            this._processVirtualAppointment(settings, $appointment, data, deferredColor)\r\n        } else {\r\n            this._createComponent($appointment, _uiScheduler4.default, {\r\n                observer: this.option(\"observer\"),\r\n                data: data,\r\n                geometry: geometry,\r\n                direction: settings.direction || \"vertical\",\r\n                allowResize: allowResize,\r\n                allowDrag: allowDrag,\r\n                allDay: allDay,\r\n                reduced: settings.appointmentReduced,\r\n                isCompact: settings.isCompact,\r\n                startDate: new Date(settings.startDate),\r\n                cellWidth: this.invoke(\"getCellWidth\"),\r\n                cellHeight: this.invoke(\"getCellHeight\"),\r\n                resizableConfig: this._resizableConfig(data, settings)\r\n            });\r\n            deferredColor.done(function(color) {\r\n                if (color) {\r\n                    $appointment.css(\"backgroundColor\", color)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    _applyResourceDataAttr: function($appointment) {\r\n        var resources = this.invoke(\"getResourcesFromItem\", this._getItemData($appointment));\r\n        if (resources) {\r\n            (0, _iterator.each)(resources, function(name, values) {\r\n                var attr = \"data-\" + _common2.default.normalizeKey(name.toLowerCase()) + \"-\";\r\n                for (var i = 0; i < values.length; i++) {\r\n                    $appointment.attr(attr + _common2.default.normalizeKey(values[i]), true)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    _resizableConfig: function(appointmentData, itemSetting) {\r\n        return {\r\n            area: this._calculateResizableArea(itemSetting, appointmentData),\r\n            onResizeStart: function(e) {\r\n                this._$currentAppointment = (0, _renderer2.default)(e.element);\r\n                if (this.invoke(\"needRecalculateResizableArea\")) {\r\n                    var updatedArea = this._calculateResizableArea(this._$currentAppointment.data(APPOINTMENT_SETTINGS_NAME), this._$currentAppointment.data(\"dxItemData\"));\r\n                    e.component.option(\"area\", updatedArea);\r\n                    e.component._renderDragOffsets(e.event)\r\n                }\r\n                this._initialSize = {\r\n                    width: e.width,\r\n                    height: e.height\r\n                };\r\n                this._initialCoordinates = _translator2.default.locate(this._$currentAppointment)\r\n            }.bind(this),\r\n            onResizeEnd: function(e) {\r\n                if (this._escPressed) {\r\n                    e.event.cancel = true;\r\n                    return\r\n                }\r\n                this._resizeEndHandler(e)\r\n            }.bind(this)\r\n        }\r\n    },\r\n    _calculateResizableArea: function(itemSetting, appointmentData) {\r\n        var area = this.$element().closest(\".dx-scrollable-content\");\r\n        return this.invoke(\"getResizableAppointmentArea\", {\r\n            coordinates: {\r\n                left: itemSetting.left,\r\n                top: 0,\r\n                groupIndex: itemSetting.groupIndex\r\n            },\r\n            allDay: itemSetting.allDay\r\n        }) || area\r\n    },\r\n    _resizeEndHandler: function(e) {\r\n        var $element = (0, _renderer2.default)(e.element);\r\n        var itemData = this._getItemData($element);\r\n        var startDate = this.invoke(\"getStartDate\", itemData, true);\r\n        var endDate = this.invoke(\"getEndDate\", itemData, true);\r\n        var dateRange = this._getDateRange(e, startDate, endDate);\r\n        var updatedDates = {};\r\n        this.invoke(\"setField\", \"startDate\", updatedDates, new Date(dateRange[0]));\r\n        this.invoke(\"setField\", \"endDate\", updatedDates, new Date(dateRange[1]));\r\n        var data = (0, _extend.extend)({}, itemData, updatedDates);\r\n        this.notifyObserver(\"updateAppointmentAfterResize\", {\r\n            target: itemData,\r\n            data: data,\r\n            $appointment: $element\r\n        })\r\n    },\r\n    _getDateRange: function(e, startDate, endDate) {\r\n        var itemData = this._getItemData(e.element);\r\n        var deltaTime = this.invoke(\"getDeltaTime\", e, this._initialSize, itemData);\r\n        var renderingStrategyDirection = this.invoke(\"getRenderingStrategyDirection\");\r\n        var isStartDateChanged = false;\r\n        var isAllDay = this.invoke(\"isAllDay\", itemData);\r\n        var needCorrectDates = this.invoke(\"needCorrectAppointmentDates\") && !isAllDay;\r\n        var startTime;\r\n        var endTime;\r\n        if (\"vertical\" !== renderingStrategyDirection || isAllDay) {\r\n            isStartDateChanged = this.option(\"rtlEnabled\") ? e.handles.right : e.handles.left\r\n        } else {\r\n            isStartDateChanged = e.handles.top\r\n        }\r\n        if (isStartDateChanged) {\r\n            startTime = needCorrectDates ? this._correctStartDateByDelta(startDate, deltaTime) : startDate.getTime() - deltaTime;\r\n            startTime += _utilsTimeZone2.default.getTimezoneOffsetChangeInMs(startDate, endDate, startTime, endDate);\r\n            endTime = endDate.getTime()\r\n        } else {\r\n            startTime = startDate.getTime();\r\n            endTime = needCorrectDates ? this._correctEndDateByDelta(endDate, deltaTime) : endDate.getTime() + deltaTime;\r\n            endTime -= _utilsTimeZone2.default.getTimezoneOffsetChangeInMs(startDate, endDate, startDate, endTime)\r\n        }\r\n        return [startTime, endTime]\r\n    },\r\n    _correctEndDateByDelta: function(endDate, deltaTime) {\r\n        var endDayHour = this.invoke(\"getEndDayHour\");\r\n        var startDayHour = this.invoke(\"getStartDayHour\");\r\n        var result = endDate.getTime() + deltaTime;\r\n        var visibleDayDuration = (endDayHour - startDayHour) * toMs(\"hour\");\r\n        var daysCount = deltaTime > 0 ? Math.ceil(deltaTime / visibleDayDuration) : Math.floor(deltaTime / visibleDayDuration);\r\n        var maxDate = new Date(endDate);\r\n        var minDate = new Date(endDate);\r\n        minDate.setHours(startDayHour, 0, 0, 0);\r\n        maxDate.setHours(endDayHour, 0, 0, 0);\r\n        if (result > maxDate.getTime() || result <= minDate.getTime()) {\r\n            var tailOfCurrentDay = maxDate.getTime() - endDate.getTime();\r\n            var tailOfPrevDays = deltaTime - tailOfCurrentDay;\r\n            var lastDay = new Date(endDate.setDate(endDate.getDate() + daysCount));\r\n            lastDay.setHours(startDayHour, 0, 0, 0);\r\n            result = lastDay.getTime() + tailOfPrevDays - visibleDayDuration * (daysCount - 1)\r\n        }\r\n        return result\r\n    },\r\n    _correctStartDateByDelta: function(startDate, deltaTime) {\r\n        var endDayHour = this.invoke(\"getEndDayHour\");\r\n        var startDayHour = this.invoke(\"getStartDayHour\");\r\n        var result = startDate.getTime() - deltaTime;\r\n        var visibleDayDuration = (endDayHour - startDayHour) * toMs(\"hour\");\r\n        var daysCount = deltaTime > 0 ? Math.ceil(deltaTime / visibleDayDuration) : Math.floor(deltaTime / visibleDayDuration);\r\n        var maxDate = new Date(startDate);\r\n        var minDate = new Date(startDate);\r\n        minDate.setHours(startDayHour, 0, 0, 0);\r\n        maxDate.setHours(endDayHour, 0, 0, 0);\r\n        if (result < minDate.getTime() || result >= maxDate.getTime()) {\r\n            var tailOfCurrentDay = startDate.getTime() - minDate.getTime();\r\n            var tailOfPrevDays = deltaTime - tailOfCurrentDay;\r\n            var firstDay = new Date(startDate.setDate(startDate.getDate() - daysCount));\r\n            firstDay.setHours(endDayHour, 0, 0, 0);\r\n            result = firstDay.getTime() - tailOfPrevDays + visibleDayDuration * (daysCount - 1)\r\n        }\r\n        return result\r\n    },\r\n    _tryGetAppointmentColor: function(appointment) {\r\n        var settings = (0, _renderer2.default)(appointment).data(APPOINTMENT_SETTINGS_NAME);\r\n        if (!settings) {\r\n            return\r\n        }\r\n        return this._getAppointmentColor(appointment, settings.groupIndex)\r\n    },\r\n    _getAppointmentColor: function($appointment, groupIndex) {\r\n        var res = new _deferred.Deferred;\r\n        var response = this.invoke(\"getAppointmentColor\", {\r\n            itemData: this._getItemData($appointment),\r\n            groupIndex: groupIndex\r\n        });\r\n        response.done(function(color) {\r\n            return res.resolve(color)\r\n        });\r\n        return res.promise()\r\n    },\r\n    _calculateBoundOffset: function() {\r\n        return this.invoke(\"getBoundOffset\")\r\n    },\r\n    _virtualAppointments: {},\r\n    _processVirtualAppointment: function(appointmentSetting, $appointment, appointmentData, color) {\r\n        var virtualAppointment = appointmentSetting.virtual;\r\n        var virtualGroupIndex = virtualAppointment.index;\r\n        if (!_type2.default.isDefined(this._virtualAppointments[virtualGroupIndex])) {\r\n            this._virtualAppointments[virtualGroupIndex] = {\r\n                coordinates: {\r\n                    top: virtualAppointment.top,\r\n                    left: virtualAppointment.left\r\n                },\r\n                items: {\r\n                    data: [],\r\n                    colors: [],\r\n                    settings: []\r\n                },\r\n                isAllDay: virtualAppointment.isAllDay ? true : false,\r\n                buttonColor: color\r\n            }\r\n        }\r\n        appointmentSetting.targetedAppointmentData = this.invoke(\"getTargetedAppointmentData\", appointmentData, $appointment);\r\n        this._virtualAppointments[virtualGroupIndex].items.settings.push(appointmentSetting);\r\n        this._virtualAppointments[virtualGroupIndex].items.data.push(appointmentData);\r\n        this._virtualAppointments[virtualGroupIndex].items.colors.push(color);\r\n        $appointment.remove()\r\n    },\r\n    _renderContentImpl: function() {\r\n        this.callBase();\r\n        this._renderDropDownAppointments()\r\n    },\r\n    _renderDropDownAppointments: function() {\r\n        (0, _iterator.each)(this._virtualAppointments, function(groupIndex) {\r\n            var virtualGroup = this._virtualAppointments[groupIndex];\r\n            var virtualItems = virtualGroup.items;\r\n            var virtualCoordinates = virtualGroup.coordinates;\r\n            var $container = virtualGroup.isAllDay ? this.option(\"allDayContainer\") : this.$element();\r\n            var left = virtualCoordinates.left;\r\n            var buttonWidth = this.invoke(\"getDropDownAppointmentWidth\", virtualGroup.isAllDay);\r\n            var buttonHeight = this.invoke(\"getDropDownAppointmentHeight\");\r\n            var rtlOffset = this.option(\"rtlEnabled\") ? buttonWidth : 0;\r\n            this.notifyObserver(\"renderCompactAppointments\", {\r\n                $container: $container,\r\n                coordinates: {\r\n                    top: virtualCoordinates.top,\r\n                    left: left + rtlOffset\r\n                },\r\n                items: virtualItems,\r\n                buttonColor: virtualGroup.buttonColor,\r\n                width: buttonWidth - this.option(\"_collectorOffset\"),\r\n                height: buttonHeight,\r\n                onAppointmentClick: this.option(\"onItemClick\"),\r\n                allowDrag: this.option(\"allowDrag\"),\r\n                cellWidth: this.invoke(\"getCellWidth\"),\r\n                isCompact: this.invoke(\"isAdaptive\") || this._isGroupCompact(virtualGroup),\r\n                applyOffset: !virtualGroup.isAllDay && this.invoke(\"isApplyCompactAppointmentOffset\")\r\n            })\r\n        }.bind(this))\r\n    },\r\n    _isGroupCompact: function(virtualGroup) {\r\n        return !virtualGroup.isAllDay && this.invoke(\"supportCompactDropDownAppointments\")\r\n    },\r\n    _sortAppointmentsByStartDate: function(appointments) {\r\n        appointments.sort(function(a, b) {\r\n            var result = 0;\r\n            var firstDate = new Date(this.invoke(\"getField\", \"startDate\", a.settings || a)).getTime();\r\n            var secondDate = new Date(this.invoke(\"getField\", \"startDate\", b.settings || b)).getTime();\r\n            if (firstDate < secondDate) {\r\n                result = -1\r\n            }\r\n            if (firstDate > secondDate) {\r\n                result = 1\r\n            }\r\n            return result\r\n        }.bind(this))\r\n    },\r\n    _processRecurrenceAppointment: function(appointment, index, skipLongAppointments) {\r\n        var recurrenceRule = this.invoke(\"getField\", \"recurrenceRule\", appointment);\r\n        var result = {\r\n            parts: [],\r\n            indexes: []\r\n        };\r\n        if (recurrenceRule) {\r\n            var dates = appointment.settings || appointment;\r\n            var startDate = new Date(this.invoke(\"getField\", \"startDate\", dates));\r\n            var endDate = new Date(this.invoke(\"getField\", \"endDate\", dates));\r\n            var appointmentDuration = endDate.getTime() - startDate.getTime();\r\n            var recurrenceException = this.invoke(\"getField\", \"recurrenceException\", appointment);\r\n            var startViewDate = this.invoke(\"getStartViewDate\");\r\n            var endViewDate = this.invoke(\"getEndViewDate\");\r\n            var recurrentDates = _utils2.default.getDatesByRecurrence({\r\n                rule: recurrenceRule,\r\n                exception: recurrenceException,\r\n                start: startDate,\r\n                end: endDate,\r\n                min: startViewDate,\r\n                max: endViewDate\r\n            });\r\n            var recurrentDateCount = appointment.settings ? 1 : recurrentDates.length;\r\n            for (var i = 0; i < recurrentDateCount; i++) {\r\n                var appointmentPart = (0, _extend.extend)({}, appointment, true);\r\n                if (recurrentDates[i]) {\r\n                    var appointmentSettings = this._applyStartDateToObj(recurrentDates[i], {});\r\n                    this._applyEndDateToObj(new Date(recurrentDates[i].getTime() + appointmentDuration), appointmentSettings);\r\n                    appointmentPart.settings = appointmentSettings\r\n                } else {\r\n                    appointmentPart.settings = dates\r\n                }\r\n                result.parts.push(appointmentPart);\r\n                if (!skipLongAppointments) {\r\n                    this._processLongAppointment(appointmentPart, result)\r\n                }\r\n            }\r\n            result.indexes.push(index)\r\n        }\r\n        return result\r\n    },\r\n    _processLongAppointment: function(appointment, result) {\r\n        var parts = this.splitAppointmentByDay(appointment);\r\n        var partCount = parts.length;\r\n        var endViewDate = this.invoke(\"getEndViewDate\").getTime();\r\n        var startViewDate = this.invoke(\"getStartViewDate\").getTime();\r\n        var startDateTimeZone = this.invoke(\"getField\", \"startDateTimeZone\", appointment);\r\n        result = result || {\r\n            parts: []\r\n        };\r\n        if (partCount > 1) {\r\n            (0, _extend.extend)(appointment, parts[0]);\r\n            for (var i = 1; i < partCount; i++) {\r\n                var startDate = this.invoke(\"getField\", \"startDate\", parts[i].settings).getTime();\r\n                startDate = this.invoke(\"convertDateByTimezone\", startDate, startDateTimeZone);\r\n                if (startDate < endViewDate && startDate > startViewDate) {\r\n                    result.parts.push(parts[i])\r\n                }\r\n            }\r\n        }\r\n        return result\r\n    },\r\n    _reduceRecurrenceAppointments: function(recurrenceIndexes, appointments) {\r\n        (0, _iterator.each)(recurrenceIndexes, function(i, index) {\r\n            appointments.splice(index - i, 1)\r\n        })\r\n    },\r\n    _combineAppointments: function(appointments, additionalAppointments) {\r\n        if (additionalAppointments.length) {\r\n            _array2.default.merge(appointments, additionalAppointments)\r\n        }\r\n        this._sortAppointmentsByStartDate(appointments)\r\n    },\r\n    _applyStartDateToObj: function(startDate, obj) {\r\n        this.invoke(\"setField\", \"startDate\", obj, startDate);\r\n        return obj\r\n    },\r\n    _applyEndDateToObj: function(endDate, obj) {\r\n        this.invoke(\"setField\", \"endDate\", obj, endDate);\r\n        return obj\r\n    },\r\n    moveAppointmentBack: function(dragEvent) {\r\n        var $appointment = this._$currentAppointment;\r\n        var size = this._initialSize;\r\n        var coords = this._initialCoordinates;\r\n        if (dragEvent) {\r\n            if (_type2.default.isDeferred(dragEvent.cancel)) {\r\n                dragEvent.cancel.resolve(true)\r\n            } else {\r\n                dragEvent.cancel = true\r\n            }\r\n        }\r\n        this.notifyObserver(\"moveBack\");\r\n        if ($appointment && !dragEvent) {\r\n            if (coords) {\r\n                _translator2.default.move($appointment, coords);\r\n                delete this._initialSize\r\n            }\r\n            if (size) {\r\n                $appointment.outerWidth(size.width);\r\n                $appointment.outerHeight(size.height);\r\n                delete this._initialCoordinates\r\n            }\r\n        }\r\n    },\r\n    focus: function() {\r\n        if (this._$currentAppointment) {\r\n            var focusedElement = (0, _dom.getPublicElement)(this._$currentAppointment);\r\n            this.option(\"focusedElement\", focusedElement);\r\n            _events_engine2.default.trigger(focusedElement, \"focus\")\r\n        }\r\n    },\r\n    splitAppointmentByDay: function(appointment) {\r\n        var dates = appointment.settings || appointment;\r\n        var originalStartDate = new Date(this.invoke(\"getField\", \"startDate\", dates));\r\n        var startDate = _date2.default.makeDate(originalStartDate);\r\n        var endDate = _date2.default.makeDate(this.invoke(\"getField\", \"endDate\", dates));\r\n        var startDateTimeZone = this.invoke(\"getField\", \"startDateTimeZone\", appointment);\r\n        var endDateTimeZone = this.invoke(\"getField\", \"endDateTimeZone\", appointment);\r\n        var maxAllowedDate = this.invoke(\"getEndViewDate\");\r\n        var startDayHour = this.invoke(\"getStartDayHour\");\r\n        var endDayHour = this.invoke(\"getEndDayHour\");\r\n        var appointmentIsLong = this.invoke(\"appointmentTakesSeveralDays\", appointment);\r\n        var result = [];\r\n        startDate = this.invoke(\"convertDateByTimezone\", startDate, startDateTimeZone);\r\n        endDate = this.invoke(\"convertDateByTimezone\", endDate, endDateTimeZone);\r\n        if (startDate.getHours() <= endDayHour && startDate.getHours() >= startDayHour && !appointmentIsLong) {\r\n            result.push(this._applyStartDateToObj(new Date(startDate), {\r\n                appointmentData: appointment\r\n            }));\r\n            startDate.setDate(startDate.getDate() + 1)\r\n        }\r\n        while (appointmentIsLong && startDate.getTime() < endDate.getTime() - 1 && startDate < maxAllowedDate) {\r\n            var currentStartDate = new Date(startDate);\r\n            var currentEndDate = new Date(startDate);\r\n            this._checkStartDate(currentStartDate, originalStartDate, startDayHour);\r\n            this._checkEndDate(currentEndDate, endDate, endDayHour);\r\n            var appointmentData = _object2.default.deepExtendArraySafe({}, appointment, true);\r\n            var appointmentSettings = {};\r\n            this._applyStartDateToObj(currentStartDate, appointmentSettings);\r\n            this._applyEndDateToObj(currentEndDate, appointmentSettings);\r\n            appointmentData.settings = appointmentSettings;\r\n            result.push(appointmentData);\r\n            startDate.setDate(startDate.getDate() + 1);\r\n            startDate.setHours(startDayHour)\r\n        }\r\n        return result\r\n    },\r\n    _checkStartDate: function(currentDate, originalDate, startDayHour) {\r\n        if (!_date2.default.sameDate(currentDate, originalDate) || currentDate.getHours() <= startDayHour) {\r\n            currentDate.setHours(startDayHour, 0, 0, 0)\r\n        } else {\r\n            currentDate.setHours(originalDate.getHours(), originalDate.getMinutes(), originalDate.getSeconds(), originalDate.getMilliseconds())\r\n        }\r\n    },\r\n    _checkEndDate: function(currentDate, originalDate, endDayHour) {\r\n        if (!_date2.default.sameDate(currentDate, originalDate) || currentDate.getHours() > endDayHour) {\r\n            currentDate.setHours(endDayHour, 0, 0, 0)\r\n        } else {\r\n            currentDate.setHours(originalDate.getHours(), originalDate.getMinutes(), originalDate.getSeconds(), originalDate.getMilliseconds())\r\n        }\r\n    }\r\n}).include(_uiScheduler2.default);\r\n(0, _component_registrator2.default)(\"dxSchedulerAppointments\", SchedulerAppointments);\r\nmodule.exports = SchedulerAppointments;\r\n"]},"metadata":{},"sourceType":"script"}