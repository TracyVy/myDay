{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointments.layout_manager.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _uiSchedulerAppointmentsStrategy = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.vertical\");\n\nvar _uiSchedulerAppointmentsStrategy2 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy);\n\nvar _uiSchedulerAppointmentsStrategy3 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal\");\n\nvar _uiSchedulerAppointmentsStrategy4 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy3);\n\nvar _uiSchedulerAppointmentsStrategy5 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month_line\");\n\nvar _uiSchedulerAppointmentsStrategy6 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy5);\n\nvar _uiSchedulerAppointmentsStrategy7 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month\");\n\nvar _uiSchedulerAppointmentsStrategy8 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy7);\n\nvar _uiSchedulerAppointmentsStrategy9 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.agenda\");\n\nvar _uiSchedulerAppointmentsStrategy10 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy9);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar RENDERING_STRATEGIES = {\n  horizontal: _uiSchedulerAppointmentsStrategy4.default,\n  horizontalMonth: _uiSchedulerAppointmentsStrategy8.default,\n  horizontalMonthLine: _uiSchedulerAppointmentsStrategy6.default,\n  vertical: _uiSchedulerAppointmentsStrategy2.default,\n  agenda: _uiSchedulerAppointmentsStrategy10.default\n};\n\nvar AppointmentLayoutManager = function () {\n  function AppointmentLayoutManager(instance, renderingStrategy) {\n    _classCallCheck(this, AppointmentLayoutManager);\n\n    this.instance = instance;\n    renderingStrategy && this.initRenderingStrategy(renderingStrategy);\n  }\n\n  _createClass(AppointmentLayoutManager, [{\n    key: \"getCellDimensions\",\n    value: function value(options) {\n      if (this.instance._workSpace) {\n        return {\n          width: this.instance._workSpace.getCellWidth(),\n          height: this.instance._workSpace.getCellHeight(),\n          allDayHeight: this.instance._workSpace.getAllDayHeight()\n        };\n      }\n    }\n  }, {\n    key: \"getGroupOrientation\",\n    value: function value(options) {\n      if (this.instance._workSpace) {\n        options.callback(this.instance._workSpace._getRealGroupOrientation());\n      }\n    }\n  }, {\n    key: \"initRenderingStrategy\",\n    value: function value(renderingStrategy) {\n      var Strategy = RENDERING_STRATEGIES[renderingStrategy];\n      this._renderingStrategyInstance = new Strategy(this.instance);\n      this.renderingStrategy = renderingStrategy;\n    }\n  }, {\n    key: \"createAppointmentsMap\",\n    value: function value(items) {\n      var _this = this;\n\n      var _this$getCellDimensio = this.getCellDimensions(),\n          width = _this$getCellDimensio.width,\n          height = _this$getCellDimensio.height,\n          allDayHeight = _this$getCellDimensio.allDayHeight;\n\n      this.instance._cellWidth = width;\n      this.instance._cellHeight = height;\n      this.instance._allDayCellHeight = allDayHeight;\n      this.getGroupOrientation({\n        callback: function callback(groupOrientation) {\n          return _this.instance._groupOrientation = groupOrientation;\n        }\n      });\n      this._positionMap = this._renderingStrategyInstance.createTaskPositionMap(items);\n      return this._createAppointmentsMapCore(items || [], this._positionMap);\n    }\n  }, {\n    key: \"_createAppointmentsMapCore\",\n    value: function value(list, positionMap) {\n      var _this2 = this;\n\n      return list.map(function (data, index) {\n        if (!_this2._renderingStrategyInstance.keepAppointmentSettings()) {\n          delete data.settings;\n        }\n\n        var appointmentSettings = positionMap[index];\n        appointmentSettings.forEach(function (settings) {\n          settings.direction = \"vertical\" === _this2.renderingStrategy && !settings.allDay ? \"vertical\" : \"horizontal\";\n        });\n        return {\n          itemData: data,\n          settings: appointmentSettings,\n          needRepaint: true,\n          needRemove: false\n        };\n      });\n    }\n  }, {\n    key: \"_isDataChanged\",\n    value: function value(data) {\n      var updatedData = this.instance.getUpdatedAppointment();\n      return updatedData === data || this.instance.getUpdatedAppointmentKeys().some(function (item) {\n        return data[item.key] === item.value;\n      });\n    }\n  }, {\n    key: \"_isAppointmentShouldAppear\",\n    value: function value(currentAppointment, sourceAppointment) {\n      return currentAppointment.needRepaint && sourceAppointment.needRemove;\n    }\n  }, {\n    key: \"_isSettingChanged\",\n    value: function value(settings, sourceSetting) {\n      if (settings.length !== sourceSetting.length) {\n        return true;\n      }\n\n      for (var i = 0; i < settings.length; i++) {\n        var newSettings = settings[i];\n        var oldSettings = sourceSetting[i];\n\n        if (oldSettings) {\n          oldSettings.sortedIndex = newSettings.sortedIndex;\n        }\n\n        if (!(0, _common.equalByValue)(newSettings, oldSettings)) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  }, {\n    key: \"_getAssociatedSourceAppointment\",\n    value: function value(currentAppointment, sourceAppointments) {\n      for (var i = 0; i < sourceAppointments.length; i++) {\n        var item = sourceAppointments[i];\n\n        if (item.itemData === currentAppointment.itemData) {\n          return item;\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"_getDeletedAppointments\",\n    value: function value(currentAppointments, sourceAppointments) {\n      var result = [];\n\n      for (var i = 0; i < sourceAppointments.length; i++) {\n        var sourceAppointment = sourceAppointments[i];\n\n        var currentAppointment = this._getAssociatedSourceAppointment(sourceAppointment, currentAppointments);\n\n        if (!currentAppointment) {\n          sourceAppointment.needRemove = true;\n          result.push(sourceAppointment);\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"getRepaintedAppointments\",\n    value: function value(currentAppointments, sourceAppointments) {\n      var _this3 = this;\n\n      if (0 === sourceAppointments.length || \"agenda\" === this.renderingStrategy) {\n        return currentAppointments;\n      }\n\n      currentAppointments.forEach(function (appointment) {\n        var sourceAppointment = _this3._getAssociatedSourceAppointment(appointment, sourceAppointments);\n\n        if (sourceAppointment) {\n          appointment.needRepaint = _this3._isDataChanged(appointment.itemData) || _this3._isSettingChanged(appointment.settings, sourceAppointment.settings) || _this3._isAppointmentShouldAppear(appointment, sourceAppointment);\n        }\n      });\n      return currentAppointments.concat(this._getDeletedAppointments(currentAppointments, sourceAppointments));\n    }\n  }, {\n    key: \"getRenderingStrategyInstance\",\n    value: function value() {\n      return this._renderingStrategyInstance;\n    }\n  }]);\n\n  return AppointmentLayoutManager;\n}();\n\nmodule.exports = AppointmentLayoutManager;","map":{"version":3,"sources":["/Users/tracyvy/Desktop/UCB_Coding_Bootcamp/project_3/calendar/client/node_modules/devextreme/ui/scheduler/ui.scheduler.appointments.layout_manager.js"],"names":["_common","require","_uiSchedulerAppointmentsStrategy","_uiSchedulerAppointmentsStrategy2","_interopRequireDefault","_uiSchedulerAppointmentsStrategy3","_uiSchedulerAppointmentsStrategy4","_uiSchedulerAppointmentsStrategy5","_uiSchedulerAppointmentsStrategy6","_uiSchedulerAppointmentsStrategy7","_uiSchedulerAppointmentsStrategy8","_uiSchedulerAppointmentsStrategy9","_uiSchedulerAppointmentsStrategy10","obj","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","RENDERING_STRATEGIES","horizontal","default","horizontalMonth","horizontalMonthLine","vertical","agenda","AppointmentLayoutManager","renderingStrategy","initRenderingStrategy","value","options","_workSpace","width","getCellWidth","height","getCellHeight","allDayHeight","getAllDayHeight","callback","_getRealGroupOrientation","Strategy","_renderingStrategyInstance","items","_this","_this$getCellDimensio","getCellDimensions","_cellWidth","_cellHeight","_allDayCellHeight","getGroupOrientation","groupOrientation","_groupOrientation","_positionMap","createTaskPositionMap","_createAppointmentsMapCore","list","positionMap","_this2","map","data","index","keepAppointmentSettings","settings","appointmentSettings","forEach","direction","allDay","itemData","needRepaint","needRemove","updatedData","getUpdatedAppointment","getUpdatedAppointmentKeys","some","item","currentAppointment","sourceAppointment","sourceSetting","newSettings","oldSettings","sortedIndex","equalByValue","sourceAppointments","currentAppointments","result","_getAssociatedSourceAppointment","push","_this3","appointment","_isDataChanged","_isSettingChanged","_isAppointmentShouldAppear","concat","_getDeletedAppointments","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointments.layout_manager.js)\r\n * Version: 20.1.6\r\n * Build date: Fri Jul 17 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _uiSchedulerAppointmentsStrategy = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.vertical\");\r\nvar _uiSchedulerAppointmentsStrategy2 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy);\r\nvar _uiSchedulerAppointmentsStrategy3 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal\");\r\nvar _uiSchedulerAppointmentsStrategy4 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy3);\r\nvar _uiSchedulerAppointmentsStrategy5 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month_line\");\r\nvar _uiSchedulerAppointmentsStrategy6 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy5);\r\nvar _uiSchedulerAppointmentsStrategy7 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month\");\r\nvar _uiSchedulerAppointmentsStrategy8 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy7);\r\nvar _uiSchedulerAppointmentsStrategy9 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.agenda\");\r\nvar _uiSchedulerAppointmentsStrategy10 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy9);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar RENDERING_STRATEGIES = {\r\n    horizontal: _uiSchedulerAppointmentsStrategy4.default,\r\n    horizontalMonth: _uiSchedulerAppointmentsStrategy8.default,\r\n    horizontalMonthLine: _uiSchedulerAppointmentsStrategy6.default,\r\n    vertical: _uiSchedulerAppointmentsStrategy2.default,\r\n    agenda: _uiSchedulerAppointmentsStrategy10.default\r\n};\r\nvar AppointmentLayoutManager = function() {\r\n    function AppointmentLayoutManager(instance, renderingStrategy) {\r\n        _classCallCheck(this, AppointmentLayoutManager);\r\n        this.instance = instance;\r\n        renderingStrategy && this.initRenderingStrategy(renderingStrategy)\r\n    }\r\n    _createClass(AppointmentLayoutManager, [{\r\n        key: \"getCellDimensions\",\r\n        value: function(options) {\r\n            if (this.instance._workSpace) {\r\n                return {\r\n                    width: this.instance._workSpace.getCellWidth(),\r\n                    height: this.instance._workSpace.getCellHeight(),\r\n                    allDayHeight: this.instance._workSpace.getAllDayHeight()\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: \"getGroupOrientation\",\r\n        value: function(options) {\r\n            if (this.instance._workSpace) {\r\n                options.callback(this.instance._workSpace._getRealGroupOrientation())\r\n            }\r\n        }\r\n    }, {\r\n        key: \"initRenderingStrategy\",\r\n        value: function(renderingStrategy) {\r\n            var Strategy = RENDERING_STRATEGIES[renderingStrategy];\r\n            this._renderingStrategyInstance = new Strategy(this.instance);\r\n            this.renderingStrategy = renderingStrategy\r\n        }\r\n    }, {\r\n        key: \"createAppointmentsMap\",\r\n        value: function(items) {\r\n            var _this = this;\r\n            var _this$getCellDimensio = this.getCellDimensions(),\r\n                width = _this$getCellDimensio.width,\r\n                height = _this$getCellDimensio.height,\r\n                allDayHeight = _this$getCellDimensio.allDayHeight;\r\n            this.instance._cellWidth = width;\r\n            this.instance._cellHeight = height;\r\n            this.instance._allDayCellHeight = allDayHeight;\r\n            this.getGroupOrientation({\r\n                callback: function(groupOrientation) {\r\n                    return _this.instance._groupOrientation = groupOrientation\r\n                }\r\n            });\r\n            this._positionMap = this._renderingStrategyInstance.createTaskPositionMap(items);\r\n            return this._createAppointmentsMapCore(items || [], this._positionMap)\r\n        }\r\n    }, {\r\n        key: \"_createAppointmentsMapCore\",\r\n        value: function(list, positionMap) {\r\n            var _this2 = this;\r\n            return list.map(function(data, index) {\r\n                if (!_this2._renderingStrategyInstance.keepAppointmentSettings()) {\r\n                    delete data.settings\r\n                }\r\n                var appointmentSettings = positionMap[index];\r\n                appointmentSettings.forEach(function(settings) {\r\n                    settings.direction = \"vertical\" === _this2.renderingStrategy && !settings.allDay ? \"vertical\" : \"horizontal\"\r\n                });\r\n                return {\r\n                    itemData: data,\r\n                    settings: appointmentSettings,\r\n                    needRepaint: true,\r\n                    needRemove: false\r\n                }\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_isDataChanged\",\r\n        value: function(data) {\r\n            var updatedData = this.instance.getUpdatedAppointment();\r\n            return updatedData === data || this.instance.getUpdatedAppointmentKeys().some(function(item) {\r\n                return data[item.key] === item.value\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_isAppointmentShouldAppear\",\r\n        value: function(currentAppointment, sourceAppointment) {\r\n            return currentAppointment.needRepaint && sourceAppointment.needRemove\r\n        }\r\n    }, {\r\n        key: \"_isSettingChanged\",\r\n        value: function(settings, sourceSetting) {\r\n            if (settings.length !== sourceSetting.length) {\r\n                return true\r\n            }\r\n            for (var i = 0; i < settings.length; i++) {\r\n                var newSettings = settings[i];\r\n                var oldSettings = sourceSetting[i];\r\n                if (oldSettings) {\r\n                    oldSettings.sortedIndex = newSettings.sortedIndex\r\n                }\r\n                if (!(0, _common.equalByValue)(newSettings, oldSettings)) {\r\n                    return true\r\n                }\r\n            }\r\n            return false\r\n        }\r\n    }, {\r\n        key: \"_getAssociatedSourceAppointment\",\r\n        value: function(currentAppointment, sourceAppointments) {\r\n            for (var i = 0; i < sourceAppointments.length; i++) {\r\n                var item = sourceAppointments[i];\r\n                if (item.itemData === currentAppointment.itemData) {\r\n                    return item\r\n                }\r\n            }\r\n            return null\r\n        }\r\n    }, {\r\n        key: \"_getDeletedAppointments\",\r\n        value: function(currentAppointments, sourceAppointments) {\r\n            var result = [];\r\n            for (var i = 0; i < sourceAppointments.length; i++) {\r\n                var sourceAppointment = sourceAppointments[i];\r\n                var currentAppointment = this._getAssociatedSourceAppointment(sourceAppointment, currentAppointments);\r\n                if (!currentAppointment) {\r\n                    sourceAppointment.needRemove = true;\r\n                    result.push(sourceAppointment)\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"getRepaintedAppointments\",\r\n        value: function(currentAppointments, sourceAppointments) {\r\n            var _this3 = this;\r\n            if (0 === sourceAppointments.length || \"agenda\" === this.renderingStrategy) {\r\n                return currentAppointments\r\n            }\r\n            currentAppointments.forEach(function(appointment) {\r\n                var sourceAppointment = _this3._getAssociatedSourceAppointment(appointment, sourceAppointments);\r\n                if (sourceAppointment) {\r\n                    appointment.needRepaint = _this3._isDataChanged(appointment.itemData) || _this3._isSettingChanged(appointment.settings, sourceAppointment.settings) || _this3._isAppointmentShouldAppear(appointment, sourceAppointment)\r\n                }\r\n            });\r\n            return currentAppointments.concat(this._getDeletedAppointments(currentAppointments, sourceAppointments))\r\n        }\r\n    }, {\r\n        key: \"getRenderingStrategyInstance\",\r\n        value: function() {\r\n            return this._renderingStrategyInstance\r\n        }\r\n    }]);\r\n    return AppointmentLayoutManager\r\n}();\r\nmodule.exports = AppointmentLayoutManager;\r\n"]},"metadata":{},"sourceType":"script"}